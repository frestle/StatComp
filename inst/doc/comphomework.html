<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="22010" />

<meta name="date" content="2022-12-08" />

<title>HW_vignette</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">HW_vignette</h1>
<h4 class="author">22010</h4>
<h4 class="date">2022-12-08</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(StatComp22010)</span></code></pre></div>
<hr />
<div id="question" class="section level2">
<h2>Question</h2>
<div id="hw0.jump-to-the-content" class="section level3">
<h3>HW0.<a href="#HW0">Jump to the content</a></h3>
<p><strong>1. Exercises of knitr</strong>. <a href="#question01ans">Jump
to the Answer</a></p>
<p>Use knitr to produce at least 3 examples (texts, figures,
tables).</p>
</div>
<div id="hw1.jump-to-the-content" class="section level3">
<h3>HW1.<a href="#HW1">Jump to the content</a></h3>
<p>Exercises 3.3, 3.7, 3.12, and 3.13 (pages 94-96, Statistical
Computating with R).</p>
<p><strong>1. Exercises 3.3</strong>.<a href="#question11ans">Jump to
the Answer</a></p>
<p>The Pareto(a, b) distribution has cdf<span class="math display">\[F(x)=1-(\frac{b}{x})^a,\qquad x\ge
b&gt;0,a&gt;0\]</span> Derive the probability inverse transformation
<span class="math inline">\(\small F^{−1}(U)\)</span> and use the
inverse transform method to simulate a random sample from the
Pareto(2,2) distribution. Graph the density histogram of the sample with
the Pareto(2,2) density superimposed for comparison.</p>
<p><strong>2. Exercises 3.7</strong>. <a href="#question12ans">Jump to
the Answer</a></p>
<p>Write a function to generate a random sample of size n from the
Beta(a,b) distribution by the acceptance-rejection method. Generate a
random sample of size 1000 from the Beta(3,2) distribution. Graph the
histogram of the sample with the theoretical Beta(3,2) density
superimposed.</p>
<p><strong>3. Exercises 3.12</strong>. <a href="#question13ans">Jump to
the Answer</a></p>
<p>Simulate a continuous Exponential-Gamma mixture. Suppose that the
rate parameter <span class="math inline">\(\small \Lambda\)</span> has
Gamma(r, <span class="math inline">\(\small \beta\)</span>) distribution
and Y has Exp(<span class="math inline">\(\small \Lambda\)</span>)
distribution. That is, <span class="math inline">\(\small (Y|\Lambda =
\lambda) ∼ f_Y (y|\lambda) = \lambda e^{−\lambda y}.\)</span> Generate
1000 random observations from this mixture with r = 4 and <span class="math inline">\(\small \beta\)</span> = 2.</p>
<p><strong>4. Exercises 3.13</strong>. <a href="#question14ans">Jump to
the Answer</a></p>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto
distribution with cdf<span class="math display">\[F(y) =
1-(\frac{\beta}{\beta+y})^r,\qquad y\ge 0\]</span>(This is an
alternative parameterization of the Pareto cdf given in Exercise 3.3).
Generate 1000 random observations from the mixture with r = 4 and <span class="math inline">\(\small \beta\)</span> = 2. Compare the empirical
and theoretical (Pareto) distributions by graphing the density histogram
of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="hw2.jump-to-the-content" class="section level3">
<h3>HW2.<a href="#HW2">Jump to the content</a></h3>
<p>Classwork(2022.09.23), Exercises 5.6, 5.7(pages 149-151, Statistical
Computing with R).</p>
<p><strong>1. Classwork</strong>.<a href="#question21ans">Jump to the
Answer</a></p>
<ul>
<li>For <span class="math inline">\(\small n = 10^4, 2 \times 10^4, 4
\times 10^4, 6 \times 10^4, 8 \times 10^4\)</span>, apply the fast
sorting algorithm to randomly permuted numbers of <span class="math inline">\(\small 1, . . . , n\)</span>.</li>
<li>Calculate computation time averaged over <span class="math inline">\(\small 100\)</span> simulations, denoted by <span class="math inline">\(a_n\)</span>.</li>
<li>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(\small t_n := n log(n)\)</span>, and graphically
show the results (scatter plot and regression line).</li>
</ul>
<p><strong>2. Exercises 5.6</strong>. <a href="#question22ans">Jump to
the Answer</a></p>
<p>In Example 5.7 the control variate approach was illustrated for Monte
Carlo integration of <span class="math display">\[\theta =
\int_{0}^{1}e^x dx\]</span> Now consider the antithetic variate
approach. Compute <span class="math inline">\(\small Cov(e^U,
e^{1−U})\)</span> and <span class="math inline">\(\small Var(e^U +
e^{1−U})\)</span>, where U ∼ Uniform(0,1). What is the percent reduction
in variance of <span class="math inline">\(\small \hat \theta\)</span>
that can be achieved using antithetic variates (compared with simple
MC)?</p>
<p><strong>3. Exercises 5.7</strong>. <a href="#question23ans">Jump to
the Answer</a></p>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach
and by the simple Monte Carlo method. Compute an empirical estimate of
the percent reduction in variance using the antithetic variate. Compare
the result with the theoretical value from Exercise 5.6.</p>
</div>
<div id="hw3.jump-to-the-content" class="section level3">
<h3>HW3.<a href="#HW3">Jump to the content</a></h3>
<p>Exercises 5.13, 5.15(pages 149-151, Statistical Computing with
R).</p>
<p><strong>2. Exercises 5.13</strong>. <a href="#question31ans">Jump to
the Answer</a></p>
<p>Find two importance functions <span class="math inline">\(\small
f_1\)</span> and <span class="math inline">\(\small f_2\)</span> that
are supported on <span class="math inline">\((1, \infty)\)</span> and
are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\qquad
x&gt;1\]</span> Which of your two importance functions should produce
the smaller variance in estimating <span class="math display">\[\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span>
by importance sampling? Explain.</p>
<p><strong>3. Exercises 5.15</strong>. <a href="#question32ans">Jump to
the Answer</a></p>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10.</p>
</div>
<div id="hw4.jump-to-the-content" class="section level3">
<h3>HW4.<a href="#HW4">Jump to the content</a></h3>
<p>Exercises 6.4, 6.8(pages 180-181, Statistical Computing with R).
Discussion (homework).</p>
<p><strong>1. Exercises 6.4</strong>. <a href="#question41ans">Jump to
the Answer</a></p>
<p>Suppose that <span class="math inline">\(\small X_1,...,X_n\)</span>
are a random sample from a from a lognormal distribution with unknown
parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\small \mu\)</span>. Use a Monte Carlo method to
obtain an empirical estimate of the confidence level.</p>
<p><strong>2. Exercises 6.8</strong>. <a href="#question42ans">Jump to
the Answer</a></p>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10.</p>
<p><strong>3. Discussion</strong>. <a href="#question43ans">Jump to the
Answer</a></p>
<p><strong><em>•</em></strong>If we obtain the powers for two methods
under a particular simulation setting with 10,000 experiments: say,
0.651 for one method and 0.676 for another method. Can we say the powers
are different at 0.05 level?</p>
<p><strong><em>•</em></strong> What is the corresponding hypothesis test
problem?</p>
<p><strong><em>•</em></strong> Which test can we use? Z-test, two-sample
t-test, paired-t test or McNemar test? Why?</p>
<p><strong><em>•</em></strong> Please provide the least necessary
information for hypothesis testing.</p>
</div>
<div id="hw5.jump-to-the-content" class="section level3">
<h3>HW5.<a href="#HW5">Jump to the content</a></h3>
<p>Exercises 7.4, 7.5, 7.A(pages 212-213, Statistical Computing with
R).</p>
<p><strong>1. Exercises 7.4</strong>. <a href="#question51ans">Jump to
the Answer</a></p>
<p>Refer to the air-conditioning data set aircondit provided in the boot
package. The 12 observations are the times in hours between failures of
airconditioning equipment [63, Example 1.1]:</p>
<p>3, 5, 7, 18, 43, 85, 91, 98, 100, 130, 230, 487.</p>
<p>Assume that the times between failures follow an exponential model
<span class="math inline">\(\small Exp(\lambda)\)</span>. Obtain the MLE
of the hazard rate <span class="math inline">\(\small \lambda\)</span>
and use bootstrap to estimate the bias and standard error of the
estimate.</p>
<p><strong>2. Exercises 7.5</strong>. <a href="#question52ans">Jump to
the Answer</a></p>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures <span class="math inline">\(\small
1/\lambda\)</span> by the standard normal, basic, percentile, and BCa
methods. Compare the intervals and explain why they may differ.</p>
<p><strong>3. Exercises 7.A</strong>. <a href="#question53ans">Jump to
the Answer</a></p>
<p>Conduct a Monte Carlo study to estimate the coverage probabilities of
the standard normal bootstrap confidence interval, the basic bootstrap
confidence interval, and the percentile confidence interval. Sample from
a normal population and check the empirical coverage rates for the
sample mean. Find the proportion of times that the confidence intervals
miss on the left, and the proportion of times that the confidence
intervals miss on the right.</p>
</div>
<div id="hw6.jump-to-the-content" class="section level3">
<h3>HW6.<a href="#HW6">Jump to the content</a></h3>
<p>Exercises 7.8, 7.11, 8.2(pages 212-213, 242, Statistical Computing
with R).</p>
<p><strong>1. Exercises 7.8</strong>. <a href="#question61ans">Jump to
the Answer</a></p>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\small \hat
\theta\)</span>.</p>
<p><strong>2. Exercises 7.11</strong>. <a href="#question62ans">Jump to
the Answer</a></p>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models.</p>
<p><strong>3. Exercises 8.2</strong>. <a href="#question63ans">Jump to
the Answer</a></p>
<p>Implement the bivariate Spearman rank correlation test for
independence [255] as a permutation test. The Spearman rank correlation
test statistic can be obtained from function cor with method =
“spearman”. Compare the achieved significance level of the permutation
test with the p-value reported by cor.test on the same samples.</p>
</div>
<div id="hw7.jump-to-the-content" class="section level3">
<h3>HW7.<a href="#HW7">Jump to the content</a></h3>
<ul>
<li>Exercises 9.4, 9.7(pages 277-278, Statistical Computing with
R).</li>
</ul>
<p>For each of the above exercise, use the Gelman-Rubin method to
monitor convergence of the chain, and run the chain until it converges
approximately to the target distribution according to <span class="math inline">\(\small \hat R &lt;1.2\)</span>.</p>
<p><strong>1. Exercises 9.4</strong>. <a href="#question71ans">Jump to
the Answer</a></p>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</p>
<p><strong>2. Exercises 9.7</strong>. <a href="#question72ans">Jump to
the Answer</a></p>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\(\small (X_t, Y_t)\)</span> with zero means, unit
standard deviations, and correlation 0.9. Plot the generated sample
after discarding a suitable burn-in sample. Fit a simple linear
regression model <span class="math inline">\(\small Y = β_0 +
β_1X\)</span> to the sample and check the residuals of the model for
normality and constant variance.</p>
</div>
<div id="hw8.jump-to-the-content" class="section level3">
<h3>HW8.<a href="#HW8">Jump to the content</a></h3>
<ul>
<li>test of mesomeric effect, Homework .</li>
</ul>
<p><strong>1. mediation analysis</strong>. <a href="#question81ans">Jump
to the Answer</a></p>
<p><span class="math display">\[X \stackrel{\alpha}{\longrightarrow} M
\stackrel{\beta}{\longrightarrow}
Y,X\stackrel{\gamma}{\longrightarrow}Y\]</span></p>
<p><span class="math display">\[H_0:\alpha \beta=0
\longleftrightarrow  H_a：\alpha \beta\ne0\]</span></p>
<p>Set up a stochastic simulation study to investigate the performance
of the three displacement testing method including:</p>
<ul>
<li><span class="math inline">\(\small \alpha = 0\)</span>,</li>
<li><span class="math inline">\(\small \beta = 0\)</span>,</li>
<li><span class="math inline">\(\small \alpha=\beta=0\)</span>.</li>
</ul>
<p>Consider the model: <span class="math display">\[M = a_M+\alpha
X+e_M\]</span> <span class="math display">\[Y = a_Y+\beta M+\gamma
X+e_Y,\quad e_M,e_Y\stackrel{i.i.d.}{\sim} N(0,1)\]</span> hint:
Consider three parameter combinations:</p>
<ul>
<li><span class="math inline">\(\small \alpha = 1,\beta = 0,\gamma =
1\)</span>,</li>
<li><span class="math inline">\(\small \alpha = 0,\beta = 1,\gamma =
1\)</span>,</li>
<li><span class="math inline">\(\small \alpha = 0,\beta = 0,\gamma =
1\)</span>,</li>
</ul>
<p><strong>2. Homework</strong>. <a href="#question82ans">Jump to the
Answer</a></p>
<p>Consider the model: <span class="math display">\[P(Y=1|X_1,X_2,X_3) =
expit(a+b_1X_1+b_2X_2+b_3X_3)\]</span> in which, <span class="math display">\[X_1\sim P(1),X_2\sim Exp(1),X_3\sim
B(1,0.5)\]</span></p>
<ul>
<li><p>Define an R-function to achieve the functions above, input: <span class="math inline">\(\small N,b_1,b_2,b_3,f_0\)</span>, output: <span class="math inline">\(\small \alpha\)</span></p></li>
<li><p>Call this function with input <span class="math inline">\(\small
N=1e6,b_1=0,b_2=1,b_3=-1,f_0=0.1,0.01,0.001,0.0001.\)</span></p></li>
<li><p>Make out the figure of <span class="math inline">\(\small \ f_0
\  vs. \ \alpha\)</span>.</p></li>
</ul>
</div>
<div id="hw9.jump-to-the-content" class="section level3">
<h3>HW9.<a href="#HW9">Jump to the content</a></h3>
<ul>
<li>2.1.3 Exercise 4, 5 (Pages 19 Advanced in R),</li>
<li>2.3.1 Exercise 1, 2 (Pages 26 Advanced in R),</li>
<li>2.4.5 Exercise 1, 2, 3 (Pages 30 Advanced in R),</li>
<li>Classwork.</li>
</ul>
<p><strong>1. 2.1.3 Exercise 4, 5</strong>. <a href="#question91ans">Jump to the Answer</a></p>
<p><strong>2. 2.3.1 Exercise 1, 2</strong>. <a href="#question92ans">Jump to the Answer</a></p>
<p><strong>3. 2.4.5 Exercise 1, 2, 3</strong>. <a href="#question93ans">Jump to the Answer</a></p>
<p><strong>4. Classwork</strong>. <a href="#question94ans">Jump to the
Answer</a></p>
</div>
<div id="hw10.jump-to-the-content" class="section level3">
<h3>HW10.<a href="#HW10">Jump to the content</a></h3>
<ul>
<li><p>11.1.2 Exercises 2 (page 204, Advanced R),</p></li>
<li><p>11.2.5 Exercises 1 (page 213, Advanced R),</p></li>
<li><p>Implement a Gibbs sampler to generate a bivariate normal chain
(<span class="math inline">\(\small X_t, Y_t\)</span>) with zero means,
unit standard deviations, and correlation 0.9.</p>
<ul>
<li><p>Write an Rcpp function.</p></li>
<li><p>Compare the corresponding generated random numbers with pure R
language using the function “qqplot”.</p></li>
<li><p>Compare the computation time of the two functions with the
function “microbenchmark”.</p></li>
</ul></li>
</ul>
<p><strong>1. 11.1.2 Exercise 2</strong>. <a href="#question101ans">Jump
to the Answer</a> The function below scales a vector so it falls in the
range [0,1]. How would you apply it to every column of a data frame? How
would you apply it to every numeric column in a data frame?</p>
<p>scale01 &lt;- function(x) { rng &lt;- range(x, na.rm = TRUE) (x -
rng[1]) / (rng[2] - rng[1]) }</p>
<p><strong>2. 11.2.5 Exercise 1</strong>. <a href="#question102ans">Jump
to the Answer</a></p>
<p>Use vapply() to: - Compute the standard deviation of every column in
a numeric data frame. - Compute the standard deviation of every numeric
column in a mixed data frame. (Hint: you’ll need to use vapply()
twice.)</p>
<p><strong>3. 2.4.5 Exercise 1, 2, 3</strong>. <a href="#question103ans">Jump to the Answer</a></p>
<p><strong>4. Classwork</strong>. <a href="#question104ans">Jump to the
Answer</a></p>
<hr />
</div>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
</div>
<div id="HW0" class="section level2">
<h2>HW0</h2>
<hr />
<div id="question01ans" class="section level3">
<h3>Question 1</h3>
<p><strong><em>step0</em></strong>. preparation</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span> (<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;knitr&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>dataset1 <span class="ot">&lt;-</span> mtcars</span></code></pre></div>
<p><strong><em>step1</em></strong>. texts</p>
<p><span class="math display">\[\begin{align*}
a_1x_1+b_1x_2=c_1 \\
b_1x_1+b_2x_2=c_2
\end{align*}\]</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(dataset1)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;Mazda RX4&quot;           &quot;Mazda RX4 Wag&quot;       &quot;Datsun 710&quot;         </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4] &quot;Hornet 4 Drive&quot;      &quot;Hornet Sportabout&quot;   &quot;Valiant&quot;            </span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7] &quot;Duster 360&quot;          &quot;Merc 240D&quot;           &quot;Merc 230&quot;           </span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10] &quot;Merc 280&quot;            &quot;Merc 280C&quot;           &quot;Merc 450SE&quot;         </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13] &quot;Merc 450SL&quot;          &quot;Merc 450SLC&quot;         &quot;Cadillac Fleetwood&quot; </span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [16] &quot;Lincoln Continental&quot; &quot;Chrysler Imperial&quot;   &quot;Fiat 128&quot;           </span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [19] &quot;Honda Civic&quot;         &quot;Toyota Corolla&quot;      &quot;Toyota Corona&quot;      </span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [22] &quot;Dodge Challenger&quot;    &quot;AMC Javelin&quot;         &quot;Camaro Z28&quot;         </span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [25] &quot;Pontiac Firebird&quot;    &quot;Fiat X1-9&quot;           &quot;Porsche 914-2&quot;      </span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [28] &quot;Lotus Europa&quot;        &quot;Ford Pantera L&quot;      &quot;Ferrari Dino&quot;       </span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [31] &quot;Maserati Bora&quot;       &quot;Volvo 142E&quot;</span></span></code></pre></div>
<p><strong><em>step2</em></strong>. figures</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>disp <span class="ot">&lt;-</span> mtcars<span class="sc">$</span>disp </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>hist_disp <span class="ot">&lt;-</span> <span class="fu">hist</span>(disp, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">breaks=</span><span class="dv">9</span>, <span class="at">xlab=</span><span class="st">&quot;disp&quot;</span>, <span class="at">main=</span><span class="st">&quot;histgram of disp in dataset</span><span class="sc">\&quot;</span><span class="st">mtcars</span><span class="sc">\&quot;</span><span class="st">&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong><em>step3</em></strong>. tables</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(dataset1))</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="26%" />
<col width="7%" />
<col width="5%" />
<col width="7%" />
<col width="5%" />
<col width="7%" />
<col width="8%" />
<col width="8%" />
<col width="4%" />
<col width="4%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="right">vs</th>
<th align="right">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Mazda RX4</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.620</td>
<td align="right">16.46</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Mazda RX4 Wag</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.875</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">Datsun 710</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">108</td>
<td align="right">93</td>
<td align="right">3.85</td>
<td align="right">2.320</td>
<td align="right">18.61</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Hornet 4 Drive</td>
<td align="right">21.4</td>
<td align="right">6</td>
<td align="right">258</td>
<td align="right">110</td>
<td align="right">3.08</td>
<td align="right">3.215</td>
<td align="right">19.44</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Hornet Sportabout</td>
<td align="right">18.7</td>
<td align="right">8</td>
<td align="right">360</td>
<td align="right">175</td>
<td align="right">3.15</td>
<td align="right">3.440</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Valiant</td>
<td align="right">18.1</td>
<td align="right">6</td>
<td align="right">225</td>
<td align="right">105</td>
<td align="right">2.76</td>
<td align="right">3.460</td>
<td align="right">20.22</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
</div>
<div id="HW1" class="section level2">
<h2>HW1</h2>
<div id="question11ans" class="section level3">
<h3>Question 1</h3>
<p><strong><em>step1</em></strong>. Derive the probability inverse
transformation: <span class="math inline">\(\small
F^{−1}(U)\)</span>.<span class="math display">\[F^{−1}(U)=b\cdot
(1-U)^{-1/a},\qquad a&gt;0,b&gt;0,0\le U\le 1\]</span>
<strong><em>step2</em></strong>. Use the inverse transform method to
simulate a random sample from the Pareto(2,2) distribution.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fl">1e3</span> <span class="co">#n for all problems thus without distinction.</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>a_pareto_Q1 <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>b_pareto_Q1 <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">91501</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>u_Q1 <span class="ot">=</span> <span class="fu">runif</span>(n)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>x_Q1 <span class="ot">=</span> b_pareto_Q1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u_Q1)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>a_pareto_Q1) <span class="co">#we know it from step1.</span></span></code></pre></div>
<p><strong><em>step3</em></strong>. Derive the density of Pareto
distribution:<span class="math display">\[f(x)=F^{&#39;}(x)=a\cdot
b^a\cdot x^{-(a+1)},\qquad x\ge b&gt;0,a&gt;0\]</span>
<strong><em>step4</em></strong>. Graph the density histogram of the
sample with the Pareto(2,2) density superimposed for comparison.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x_Q1, <span class="at">prob=</span><span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">&quot;Inverse Transform Method for Pareto(2,2)&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;x&quot;</span>) <span class="co">#we know the function from step1.</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>y_Q1 <span class="ot">=</span> <span class="fu">seq</span>(b_pareto_Q1, <span class="dv">100</span>, .<span class="dv">01</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y_Q1, a_pareto_Q1<span class="sc">*</span>b_pareto_Q1<span class="sc">^</span>a_pareto_Q1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>y_Q1)<span class="sc">^</span>(a_pareto_Q1<span class="sc">+</span><span class="dv">1</span>),<span class="at">lwd=</span><span class="fl">1.5</span>) </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We see that the two fit really well.</p>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
<div id="question12ans" class="section level3">
<h3>Question 2</h3>
<p><strong><em>step1</em></strong>. Write a function to generate a
random sample of size n from the Beta(a,b) distribution by the
acceptance-rejection method. Choose <strong>Uniform(0,1)</strong> as the
envelope distribution and choose <strong>function”optimize”</strong> to
find the best <strong>c</strong> for the algorithm.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Gen_beta <span class="ot">=</span> <span class="cf">function</span>(n,a,b){</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> <span class="fu">numeric</span>(n)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (k <span class="sc">&lt;</span> n){</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co">#the envelope distribution.</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#use optimize to find the best c in acceptance-rejection method with accuracy 0.001.</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    max_beta <span class="ot">=</span> <span class="fu">optimize</span>(f<span class="ot">&lt;-</span><span class="cf">function</span>(x) {x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>)},<span class="at">interval=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">tol=</span><span class="fl">0.001</span>,<span class="at">maximum =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>maximum </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>)<span class="sc">&gt;</span>(max_beta<span class="fl">+0.001</span>)<span class="sc">*</span>u){</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>      <span class="co">#accept x</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">=</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>      y[k] <span class="ot">=</span> x</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong><em>step2</em></strong>. Generate a random sample of size
1000 from the Beta(3,2) distribution.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>a_Q2 <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>b_Q2 <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">91802</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>sample_Q2 <span class="ot">=</span> <span class="fu">Gen_beta</span>(n,a_Q2,b_Q2)</span></code></pre></div>
<p><strong><em>step3</em></strong>. The theoretical Beta(3,2)
density:<span class="math display">\[f(x)=12x^2(1-x)I_{(0,1)}(x)\]</span>
<strong><em>step4</em></strong>. Graph the histogram of the sample with
the theoretical Beta(3,2) density superimposed.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_Q2, <span class="at">prob=</span><span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">&quot;Acceptance-Rejection Method for Beta(3,2)&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;x&quot;</span>) <span class="co">#we know the function from step3.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>y_Q2 <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">01</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y_Q2, <span class="dv">12</span><span class="sc">*</span>y_Q2<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y_Q2),<span class="at">lwd=</span><span class="fl">1.5</span>) </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We see that the two fit really well.</p>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
<div id="question13ans" class="section level3">
<h3>Question 3</h3>
<p><strong><em>step</em></strong>. First, generate rate parameter <span class="math inline">\(\small \Lambda\)</span> that has Gamma(r, <span class="math inline">\(\small \beta\)</span>) distribution. Then,
Generate Y with the generated <span class="math inline">\(\small
\Lambda\)</span> as a parameter, respectively.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>r_Q3 <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>beta_Q3 <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">91503</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>lambda_Q3 <span class="ot">=</span> <span class="fu">rgamma</span>(n,<span class="at">shape=</span><span class="dv">4</span>,<span class="at">rate=</span>beta_Q3)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>y_Q3 <span class="ot">=</span> <span class="fu">rexp</span>(n,lambda_Q3)</span></code></pre></div>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
<div id="question14ans" class="section level3">
<h3>Question 4</h3>
<p><strong><em>step1</em></strong>. By comparison, we could see that in
Question4 the parameters of pareto distribution are different, now the
density of the pareto(by mixture) distribution is:<span class="math display">\[f(y)=r\cdot \beta^r\cdot
(\beta+y)^{-(r+1)},\qquad y\ge0,r&gt;0,\beta&gt;0\]</span><br />
<strong><em>step2</em></strong>. Graph the density histogram of the
sample and superimpose the Pareto density curve.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">91504</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>lambda_Q4 <span class="ot">=</span> <span class="fu">rgamma</span>(n,<span class="at">shape=</span>r_Q3,<span class="at">rate=</span>beta_Q3)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>y_Q4 <span class="ot">=</span> <span class="fu">rexp</span>(n,lambda_Q4)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y_Q4, <span class="at">prob=</span><span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">&quot;Empirical and Theoretical Pareto Distributions&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;x&quot;</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>z_Q4 <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, .<span class="dv">01</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(z_Q4, r_Q3<span class="sc">*</span>beta_Q3<span class="sc">^</span>r_Q3<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>(z_Q4<span class="sc">+</span>beta_Q3))<span class="sc">^</span>(r_Q3<span class="sc">+</span><span class="dv">1</span>),<span class="at">lwd=</span><span class="fl">1.5</span>) <span class="co">#we know the function from step3.</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We see the two of empirical and theoretical Pareto distributions fit
really well.</p>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
</div>
<div id="HW2" class="section level2">
<h2>HW2</h2>
<hr />
<div id="question21ans" class="section level3">
<h3>Question 1</h3>
<p><strong><em>step1</em></strong>. For <span class="math inline">\(\small n = 10^4, 2 \times 10^4, 4 \times 10^4, 6
\times 10^4, 8 \times 10^4\)</span>, apply the fast sorting algorithm to
randomly permuted numbers of <span class="math inline">\(\small 1, . . .
, n\)</span>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span> (<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1e4</span>,<span class="dv">2</span><span class="sc">*</span><span class="fl">1e4</span>,<span class="dv">4</span><span class="sc">*</span><span class="fl">1e4</span>,<span class="dv">6</span><span class="sc">*</span><span class="fl">1e4</span>,<span class="dv">8</span><span class="sc">*</span><span class="fl">1e4</span>) <span class="co">#numbers set</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">100</span> <span class="co">#times set</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>quick_sort<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  num <span class="ot">=</span> <span class="fu">length</span>(x)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(num <span class="sc">==</span> <span class="dv">0</span><span class="sc">||</span>num <span class="sc">==</span> <span class="dv">1</span>){<span class="fu">return</span>(x)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">=</span> x[<span class="dv">1</span>]</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=</span> x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    lower <span class="ot">=</span> y[y<span class="sc">&lt;</span>a]</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    upper <span class="ot">=</span> y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),a,<span class="fu">quick_sort</span>(upper)))} <span class="co">#form a loop statement</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>quick_sort_1<span class="ot">&lt;-</span><span class="cf">function</span>(x){ <span class="co">#prepare for the calculation of computation time</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>x) <span class="co">#for the step2 operation seed is not set</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">system.time</span>(<span class="fu">quick_sort</span>(y))[<span class="dv">1</span>])</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>time_Q1 <span class="ot">=</span> <span class="fu">lapply</span>(m,quick_sort_1)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>result_Q1 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(m,time_Q1),<span class="at">ncol =</span> <span class="dv">2</span>)) <span class="co">#show the result in the form of table</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_Q1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;number&quot;</span>,<span class="st">&quot;time(s)&quot;</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(result_Q1,<span class="at">caption =</span> <span class="st">&quot;Fast Sorting Algorithm Time for Randomly Permuted Numbers&quot;</span>)</span></code></pre></div>
<table>
<caption>Fast Sorting Algorithm Time for Randomly Permuted
Numbers</caption>
<thead>
<tr class="header">
<th align="left">number</th>
<th align="left">time(s)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">10000</td>
<td align="left">0.02</td>
</tr>
<tr class="even">
<td align="left">20000</td>
<td align="left">0.05</td>
</tr>
<tr class="odd">
<td align="left">40000</td>
<td align="left">0.08</td>
</tr>
<tr class="even">
<td align="left">60000</td>
<td align="left">0.09</td>
</tr>
<tr class="odd">
<td align="left">80000</td>
<td align="left">0.14</td>
</tr>
</tbody>
</table>
<p><strong><em>step2</em></strong>. Calculate computation time averaged
over <span class="math inline">\(\small 100\)</span> simulations,
denoted by <span class="math inline">\(a_n\)</span>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>m_loop <span class="ot">=</span> <span class="fu">rep</span>(m,n)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>time_Q1_loop <span class="ot">=</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(m_loop,quick_sort_1)) <span class="co">#just for habit,avoid using loops with &quot;for&quot;,&quot;while&quot;,etc.</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>time_Q1_aver <span class="ot">=</span> <span class="fu">rowMeans</span>(<span class="fu">matrix</span>(time_Q1_loop,<span class="at">nrow =</span> <span class="dv">5</span>))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>result_Q1_aver <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(m,time_Q1_aver),<span class="at">ncol =</span> <span class="dv">2</span>)) <span class="co">#show the result in the form of table</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_Q1_aver) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;number&quot;</span>,<span class="st">&quot;aver_time over 100(s)&quot;</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(result_Q1_aver,<span class="at">caption =</span> <span class="st">&quot;Computation Time Averaged over 100 Simulations&quot;</span>)</span></code></pre></div>
<table>
<caption>Computation Time Averaged over 100 Simulations</caption>
<thead>
<tr class="header">
<th align="right">number</th>
<th align="right">aver_time over 100(s)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">10000</td>
<td align="right">0.0157</td>
</tr>
<tr class="even">
<td align="right">20000</td>
<td align="right">0.0310</td>
</tr>
<tr class="odd">
<td align="right">40000</td>
<td align="right">0.0695</td>
</tr>
<tr class="even">
<td align="right">60000</td>
<td align="right">0.1005</td>
</tr>
<tr class="odd">
<td align="right">80000</td>
<td align="right">0.1405</td>
</tr>
</tbody>
</table>
<p><strong><em>step3</em></strong>. Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(\small
t_n := n log(n)\)</span>, and graphically show the results (scatter plot
and regression line).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>num_trans <span class="ot">=</span> m<span class="sc">*</span><span class="fu">log</span>(m)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>data_Q1 <span class="ot">=</span> <span class="fu">data.frame</span>(num_trans,time_Q1_aver)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_Q1,<span class="fu">aes</span>(<span class="at">x=</span>num_trans,<span class="at">y=</span>time_Q1_aver)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">shape=</span><span class="dv">19</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;nlog(n)&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;time&quot;</span>)<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&quot;Regress time on nlog(n)&quot;</span>)<span class="sc">+</span><span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using formula = &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The graphic above shows the regression of <span class="math inline">\(a_n\)</span>(computation time averaged over 100
simulations) on <span class="math inline">\(\small nlog(n)\)</span>, the
result shows that there is a clear linear relationship between them.</p>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
<div id="question22ans" class="section level3">
<h3>Question 2</h3>
<p><strong><em>step1</em></strong>. Compute <span class="math inline">\(\small Cov(e^U, e^{1−U})\)</span> and <span class="math inline">\(\small Var(e^U + e^{1−U})\)</span>, where U ∼
Uniform(0,1).</p>
<p><span class="math display">\[\begin{aligned}
Cov(e^U,e^{1-U})&amp;=E(e^{U+(1-U)})-E(e^U)E(e^{1-U}) \\
&amp;=\int_{0}^{1}edx-\int_{0}^{1}e^xdx\int_{0}^{1}e^{1-x}dx\\
&amp;=e-(e-1)^2\\
&amp;=-e^2+3e-1\\
\end{aligned}\]</span></p>
<p><span class="math display">\[\begin{aligned}
Var(e^U+e^{1-U})&amp;=E(2e^{U+(1-U)})+E(e^{2U})+E\left [e^{2(1-U)}\right
]-\left [E(e^U)+E(e^{1-U})\right ]^2 \\
&amp;=2e+(e^2-1)-(2e-2)^2\\
&amp;=-3e^2+10e-5\\
\end{aligned}\]</span></p>
<p><strong><em>step2</em></strong>. Compute variance of <span class="math inline">\(\hat \theta\)</span> using antithetic variates.
<span class="math display">\[\hat \theta^{&#39;}= \frac{1}{m}
\sum_{j=1}^{m/2}\left( e^{U_j}+e^{1-U_j}\right ),U_j\sim U(0,1)\]</span>
<span class="math display">\[\begin{aligned}
Var(\hat
\theta^{&#39;})&amp;=\frac{1}{m^2}\sum_{j=1}^{m/2}Var(e^{U_j}+e^{1-U_j})
\\
&amp;=\frac{1}{m^2}\sum_{j=1}^{m/2}(-3e^2+10e-5) \\
&amp;=\frac{1}{2m}(-3e^2+10e-5)
\end{aligned}\]</span> <strong><em>step3</em></strong>. Compute the
percent reduction in variance of <span class="math inline">\(\hat
\theta\)</span> that can be achieved using antithetic variates (compared
with simple MC).</p>
<p>Simple MC: <span class="math display">\[\hat \theta =
\frac{1}{m}\sum_{j=1}^{m}e^U_j,U_j\sim U(0,1)\]</span> <span class="math display">\[Var(\hat \theta) =
\frac{1}{m^2}\sum_{j=1}^{m}Var(e^U_j)=\frac{1}{m}\left[\frac{1}{2}(e^2-1)-(e-1)^2\right]\]</span>
<span class="math display">\[percent\; reduction = 100\frac{Var(\hat
\theta)-Var(\hat \theta^{&#39;})}{Var(\hat
\theta)}=100\frac{e^2-3e+1}{\frac{1}{2}(e^2-1)-(e-1)^2}\]</span>
<strong><em>step4</em></strong>. Use R to calculate the value of it.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>e <span class="ot">=</span> <span class="fu">exp</span>(<span class="dv">1</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span>(e<span class="sc">^</span><span class="dv">2-3</span><span class="sc">*</span>e<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="fl">0.5</span><span class="sc">*</span>(e<span class="sc">^</span><span class="dv">2-1</span>)<span class="sc">-</span>(e<span class="dv">-1</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 96.76701</span></span></code></pre></div>
<p>We see that the percent reduction in variance of <span class="math inline">\(\hat \theta\)</span> that can be achieved to about
96.767%.</p>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
<div id="question23ans" class="section level3">
<h3>Question 3</h3>
<p><strong><em>step1</em></strong>. Use a Monte Carlo simulation to
estimate <span class="math inline">\(\theta\)</span> by the antithetic
variate approach and by the simple Monte Carlo method.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>n_Q3 <span class="ot">=</span> <span class="fl">1e4</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9233</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>MC.Phi <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">R =</span> <span class="fl">1e4</span>, <span class="at">antithetic =</span> <span class="cn">TRUE</span>){ <span class="co">#two Ways to estimate theta</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>antithetic) v <span class="ot">=</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>) <span class="cf">else</span> v <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> u</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">c</span>(u, v)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">=</span> <span class="fu">exp</span>(u)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(g)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>MC1 <span class="ot">=</span> MC2 <span class="ot">=</span> <span class="fu">numeric</span>(n_Q3)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_Q3) {</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  MC1[i] <span class="ot">=</span> <span class="fu">MC.Phi</span>(<span class="at">R =</span> n_Q3, <span class="at">anti =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  MC2[i] <span class="ot">=</span> <span class="fu">MC.Phi</span>(<span class="at">R =</span> n_Q3)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>result_Q3 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">mean</span>(MC1),<span class="fu">mean</span>(MC2)),<span class="at">ncol =</span> <span class="dv">2</span>)) <span class="co">#show the result in the form of table</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_Q3) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Simple Monte Carlo&quot;</span>,<span class="st">&quot;Antithetic variate&quot;</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(result_Q3) <span class="ot">=</span> <span class="st">&quot;theta_hat&quot;</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(result_Q3,<span class="at">caption =</span> <span class="st">&quot;Value of Theta Estimated in Different Ways&quot;</span>)</span></code></pre></div>
<table>
<caption>Value of Theta Estimated in Different Ways</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Simple Monte Carlo</th>
<th align="right">Antithetic variate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">theta_hat</td>
<td align="right">1.718249</td>
<td align="right">1.718281</td>
</tr>
</tbody>
</table>
<p><strong><em>step2</em></strong>. Compute an empirical estimate of the
percent reduction in variance using the antithetic variate.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>percent <span class="ot">=</span> <span class="dv">100</span><span class="sc">*</span>(<span class="fu">var</span>(MC1)<span class="sc">-</span><span class="fu">var</span>(MC2))<span class="sc">/</span><span class="fu">var</span>(MC1)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>percent</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 96.83069</span></span></code></pre></div>
<p>We see that the percent reduction in variance using the antithetic
variate is about 96.83% ,which is almost same to the theoretical value
from Exercise 5.6 – 96.767%.</p>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
</div>
<div id="HW3" class="section level2">
<h2>HW3</h2>
<hr />
<div id="question31ans" class="section level3">
<h3>Question 1</h3>
<p><strong><em>step1</em></strong>. Find two importance functions <span class="math inline">\(\small f_1\)</span> and <span class="math inline">\(\small f_2\)</span> that are supported on <span class="math inline">\(\small (1, \infty)\)</span> and are ‘close’ to
<span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\qquad
x&gt;1\]</span>. We choose <span class="math inline">\(\small
\chi^2\)</span> distribution and rayleigh distribution with parameter
<span class="math inline">\(n=4\)</span> and <span class="math inline">\(\sigma=\sqrt2\)</span> respectively as the
importance function. <span class="math display">\[f_1(x) =
\frac{x}{4}e^{-x/2},\qquad x&gt;0\]</span> <span class="math display">\[f_2(x)=\frac{x}{2}e^{-x^2/4},\qquad
x&gt;0\]</span></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 载入需要的程辑包：stats4</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 载入需要的程辑包：splines</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">#define target function g(x).</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>G_Q1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){ </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.01</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co">#we choose importance functions:chisq(4) and rayleigh(sqrt(2))</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>data_Q1 <span class="ot">=</span> <span class="fu">data.frame</span>(x,<span class="at">g=</span><span class="fu">G_Q1</span>(x),<span class="at">chisq=</span><span class="fu">dchisq</span>(x,<span class="at">df=</span><span class="dv">4</span>),</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">rayleigh=</span><span class="fu">drayleigh</span>(x,<span class="at">scale =</span> <span class="fu">sqrt</span>(<span class="dv">2</span>),<span class="at">log=</span>F))</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co">#codes below are to graph the funtions.</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>data.plot <span class="ot">=</span> <span class="fu">melt</span>(data_Q1,<span class="at">id=</span><span class="st">&quot;x&quot;</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data.plot) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;func&quot;</span>,<span class="st">&quot;value&quot;</span>)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data.plot,<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>value,<span class="at">group =</span> func,<span class="at">color=</span>func))<span class="sc">+</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lwd=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;x&quot;</span>)<span class="sc">+</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;value&quot;</span>)<span class="sc">+</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major=</span><span class="fu">element_line</span>(<span class="at">colour=</span><span class="cn">NA</span>),</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>,<span class="at">colour =</span> <span class="cn">NA</span>),</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>,<span class="at">colour =</span> <span class="cn">NA</span>),</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">775</span>,.<span class="dv">815</span>),</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Graph of Imporance Functions and Target Function&quot;</span>)<span class="sc">+</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong><em>step2</em></strong>. Calculate the variance in estimating
<span class="math inline">\(\small \int_{1}^{\infty}g(x)dx\)</span> by
importance sampling with important functions above.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fl">1e4</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0930</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">=</span> <span class="fu">rchisq</span>(m,<span class="at">df=</span><span class="dv">4</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="fu">rrayleigh</span>(m,<span class="at">scale=</span><span class="fu">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>mean_Q1 <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">mean</span>(<span class="fu">G_Q1</span>(x1)<span class="sc">/</span><span class="fu">dchisq</span>(x1,<span class="at">df=</span><span class="dv">4</span>)),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mean</span>(<span class="fu">G_Q1</span>(x2)<span class="sc">/</span><span class="fu">drayleigh</span>(x2,<span class="at">scale=</span><span class="fu">sqrt</span>(<span class="dv">2</span>)))),<span class="dv">3</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>variance_Q1 <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">var</span>(<span class="fu">G_Q1</span>(x1)<span class="sc">/</span><span class="fu">dchisq</span>(x1,<span class="at">df=</span><span class="dv">4</span>)),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">var</span>(<span class="fu">G_Q1</span>(x2)<span class="sc">/</span><span class="fu">drayleigh</span>(x2,<span class="at">scale=</span><span class="fu">sqrt</span>(<span class="dv">2</span>)))),<span class="dv">3</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co">#codes below are to show the result in the form of table with knitr.</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>result_Q1 <span class="ot">=</span> <span class="fu">data.frame</span>(mean_Q1,variance_Q1)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_Q1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;mean&quot;</span>,<span class="st">&quot;var&quot;</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(result_Q1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;chisq&quot;</span>,<span class="st">&quot;rayleigh&quot;</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(result_Q1,<span class="at">caption =</span> <span class="st">&quot;Result of Importance Sampling&quot;</span>)</span></code></pre></div>
<table>
<caption>Result of Importance Sampling</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">mean</th>
<th align="right">var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">chisq</td>
<td align="right">0.395</td>
<td align="right">0.352</td>
</tr>
<tr class="even">
<td align="left">rayleigh</td>
<td align="right">0.404</td>
<td align="right">0.073</td>
</tr>
</tbody>
</table>
<p>The estimations by importance sampling with these two importance
functions above are close, however, there’s a huge difference of the
variance, which are 0.352 and 0.073.</p>
<p><strong><em>step3</em></strong>. Explain the result above:</p>
<p>The fact is that the importance function should be an f that is
supported on exactly the set where g(x) &gt; 0, and such that the ratio
g(x)/f(x) is nearly constant. Let’s plot the ratio function to explain
the result.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#change the data and plot again like step1.</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>data_Q1<span class="fl">.2</span> <span class="ot">=</span> <span class="fu">data.frame</span>(x,<span class="at">chisq=</span><span class="fu">G_Q1</span>(x)<span class="sc">/</span><span class="fu">dchisq</span>(x,<span class="at">df=</span><span class="dv">4</span>),</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">rayleigh=</span><span class="fu">G_Q1</span>(x)<span class="sc">/</span><span class="fu">drayleigh</span>(x, <span class="at">scale =</span> <span class="fu">sqrt</span>(<span class="dv">2</span>),<span class="at">log=</span>F))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>data.plot<span class="fl">.2</span> <span class="ot">=</span> <span class="fu">melt</span>(data_Q1<span class="fl">.2</span>,<span class="at">id=</span><span class="st">&quot;x&quot;</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data.plot<span class="fl">.2</span>) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;func&quot;</span>,<span class="st">&quot;value&quot;</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data.plot<span class="fl">.2</span>,<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>value,<span class="at">group =</span> func,<span class="at">color=</span>func))<span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lwd=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;x&quot;</span>)<span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;value&quot;</span>)<span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major=</span><span class="fu">element_line</span>(<span class="at">colour=</span><span class="cn">NA</span>),</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>,<span class="at">colour =</span> <span class="cn">NA</span>),</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>,<span class="at">colour =</span> <span class="cn">NA</span>),</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">775</span>,.<span class="dv">815</span>),</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Ratio Function of Imporance Functions and Target Function&quot;</span>)<span class="sc">+</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It’s obvious that ratio function <span class="math inline">\(\small
f_2(x)/g(x)\)</span> is more level and smooth. That’s why <span class="math inline">\(\small f_2\)</span> produce the smaller variance
in estimating.</p>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
<div id="question32ans" class="section level3">
<h3>Question 2</h3>
<p><strong><em>step1</em></strong>.Obtain Example 5.10:</p>
<p>Importance functions to estimate <span class="math display">\[\int_{0}^{1}\frac{e^{-x}}{1+x^2}dx\]</span> The
candidates for the importance functions are <span class="math display">\[f_0(x)=1,\qquad 0&lt;x&lt;1,\qquad
U(0,1)\]</span> <span class="math display">\[f_1(x)=e^{-x},\qquad
0&lt;x&lt;\infty,\qquad  E(0,1)\]</span> <span class="math display">\[f_2(x)=\pi^{-1}(1+x^2)^{-1},\qquad
-\infty&lt;x&lt;\infty,\quad Cauchy(0,1)\]</span> <span class="math display">\[f_3(x)=e^{-x}/(1-e^{-1}),\qquad
0&lt;x&lt;1\]</span> <span class="math display">\[f_4(x)=4\pi^{-1}(1+x^2)^{-1},\qquad
0&lt;x&lt;1\]</span></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#codes below are copied from Statistical Computing with R, page141.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0930</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">*</span> (x <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(m) <span class="co">#using f0</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(m, <span class="dv">1</span>) <span class="co">#using f1</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(m) <span class="co">#using f2</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which</span>(x <span class="sc">&gt;</span> <span class="dv">1</span>), <span class="fu">which</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>))</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>x[i] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co">#to catch overflow errors in g(x)</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">dcauchy</span>(x)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m) <span class="co">#f3, inverse transform method</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m) <span class="co">#f4, inverse transform method</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">tan</span>(pi <span class="sc">*</span> u <span class="sc">/</span> <span class="dv">4</span>)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> (<span class="dv">4</span> <span class="sc">/</span> ((<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> pi))</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>result_Q2<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">rbind</span>(theta.hat, se),<span class="dv">3</span>)</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_Q2<span class="fl">.1</span>) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;f_0&quot;</span>,<span class="st">&quot;f_1&quot;</span>,<span class="st">&quot;f_2&quot;</span>,<span class="st">&quot;f_3&quot;</span>,<span class="st">&quot;f_4&quot;</span>)</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(result_Q2<span class="fl">.1</span>,</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Result of Importance Sampling&quot;</span>)</span></code></pre></div>
<table>
<caption>Result of Importance Sampling</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">f_0</th>
<th align="right">f_1</th>
<th align="right">f_2</th>
<th align="right">f_3</th>
<th align="right">f_4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">theta.hat</td>
<td align="right">0.522</td>
<td align="right">0.529</td>
<td align="right">0.525</td>
<td align="right">0.524</td>
<td align="right">0.525</td>
</tr>
<tr class="even">
<td align="left">se</td>
<td align="right">0.245</td>
<td align="right">0.420</td>
<td align="right">0.948</td>
<td align="right">0.097</td>
<td align="right">0.141</td>
</tr>
</tbody>
</table>
<p><strong><em>step2</em></strong>.Obtain Example 5.13: Divide the
interval (0,1) into five subintervals, <span class="math display">\[I_j=\left \{ x : a_{j−1} ≤ x&lt;a_j \right \},a_0
= 0,a_j = F^{-1}(\frac{j}{5}),j = 1,..., 4,a_5=1\]</span> <span class="math display">\[g(x)=\frac{e^{-x}}{1+x^2}\]</span> <span class="math display">\[g_j(x) = g(x) \quad if \quad x \in I_j \quad and
\quad g_j (x) = 0 \quad otherwise\]</span> We now have 5 parameters to
estimate, <span class="math display">\[\theta_j=\int_{a_{j-1}}^{a_j}g_j(x)dx,\qquad
j=1,..,5\]</span> <span class="math display">\[\theta=\sum_{j=1}^{5}\theta_j=\int_0^1g(x)dx\]</span>
the conditional density <span class="math inline">\(f_j\)</span> of X is
defined by <span class="math display">\[f_j(x)=f_{X\mid I_j(x\mid
I_j)}=\frac{f(x,a_{j-1}&lt;x&lt;a_j)}{f(a_{j-1}&lt;x&lt;a_j)}=5f(x)=\frac{5e^{-x}}{1-e^{-1}},\quad
a_{j-1}&lt;x&lt;a_{j}\]</span> Estimate <span class="math inline">\(\theta_j\)</span> by importance sampling and sum
it to estimate <span class="math inline">\(\theta\)</span>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0930</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>f.Q2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){ <span class="co">#Density f_j(x) = k*f(x) where k=5.</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a> F.revers1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x,a){ <span class="co">#Define the reverse pmf of the density above.</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>   <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>a)<span class="sc">-</span><span class="fl">0.2</span><span class="sc">*</span>x<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a> F.revers <span class="ot">&lt;-</span> <span class="cf">function</span>(x){ <span class="co">#Define the reverse pmf of f_3 to split the interval.</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>   <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>x<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>inteval <span class="ot">=</span> <span class="fu">unlist</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span><span class="sc">/</span><span class="dv">5</span>, F.revers),<span class="dv">1</span>))</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>inteval</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.0000000 0.1351603 0.2914869 0.4768628 0.7046055 1.0000000</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>theta.hat.str<span class="ot">=</span>va<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(m<span class="sc">/</span><span class="dv">5</span>)            </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">F.revers1</span>(u,inteval[i]) <span class="co">#Generate random numbers by f_j.</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  fg <span class="ot">=</span> <span class="fu">g</span>(x)<span class="sc">*</span>(x<span class="sc">&gt;=</span>inteval[i])<span class="sc">*</span>(x<span class="sc">&lt;</span>inteval[i<span class="sc">+</span><span class="dv">1</span>])<span class="sc">/</span><span class="fu">f.Q2</span>(x) </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  theta.hat.str[i] <span class="ot">=</span> <span class="fu">mean</span>(fg)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  va[i] <span class="ot">=</span> <span class="fu">var</span>(fg)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>result_Q2<span class="fl">.2</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">data.frame</span>(<span class="fu">sum</span>(theta.hat.str),<span class="fu">sqrt</span>(<span class="fu">sum</span>(va))),<span class="dv">4</span>)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_Q2<span class="fl">.2</span>) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Mean&quot;</span>,<span class="st">&quot;Se&quot;</span>)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(result_Q2<span class="fl">.2</span>,</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Result of Stratified Importance Sampling&quot;</span>)</span></code></pre></div>
<table>
<caption>Result of Stratified Importance Sampling</caption>
<thead>
<tr class="header">
<th align="right">Mean</th>
<th align="right">Se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.5248</td>
<td align="right">0.0093</td>
</tr>
</tbody>
</table>
<p><strong><em>step3</em></strong>.Comparison of Example 5.10 and
5.13:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>result_Q2 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">sum</span>(theta.hat.str),theta.hat[<span class="dv">4</span>],<span class="fu">sqrt</span>(<span class="fu">sum</span>(va)),se[<span class="dv">4</span>]),</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>,<span class="at">dimnames=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;EX5.13&quot;</span>,<span class="st">&quot;EX5.10&quot;</span>),<span class="fu">c</span>(<span class="st">&quot;Mean&quot;</span>,<span class="st">&quot;Se&quot;</span>)))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">round</span>(result_Q2,<span class="dv">4</span>),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Comparison between the Results of 2 Examples&quot;</span>)</span></code></pre></div>
<table>
<caption>Comparison between the Results of 2 Examples</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Mean</th>
<th align="right">Se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">EX5.13</td>
<td align="right">0.5248</td>
<td align="right">0.0093</td>
</tr>
<tr class="even">
<td align="left">EX5.10</td>
<td align="right">0.5236</td>
<td align="right">0.0965</td>
</tr>
</tbody>
</table>
<p>The estimations by pure importance sampling and stratified importance
sampling are close, however, there’s a huge difference of the variance,
which are 0.0965 and 0.0093, which shows the advantages of stratified
importance sampling–reducing variance.</p>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
</div>
<div id="HW4" class="section level2">
<h2>HW4</h2>
<hr />
<div id="question41ans" class="section level3">
<h3>Question 1</h3>
<p><strong><em>step1</em></strong>. Construct a 95% confidence interval
for the parameter <span class="math inline">\(\small \mu\)</span>.</p>
<p>Suppose that <span class="math inline">\(\small X_1,...,X_n\)</span>
are a random sample from a from a lognormal distribution with unknown
parameters. That is, <span class="math inline">\(\small
log(X_1),...,log(X_n)\sim N(\mu,\sigma^2),\)</span> with unknown <span class="math inline">\(\small \mu,\sigma^2\)</span>, with basic content
of interval estimation:</p>
<p><span class="math display">\[\frac{\sqrt n
(\overline{log(x)}-\mu)}{S_l} \sim t_{n-1},\]</span> in which <span class="math display">\[S_l=\frac{1}{n-1}\sum_{i=1}^{n}\left [
log(X_i)-\overline{log(X)} \right ]^2.\]</span></p>
<p><span class="math display">\[P \left (\frac{\sqrt n \left
|\overline{log(x)}-\mu \right |}{S_l} \le t_{n-1}(0.025)\right
)=0.95\]</span></p>
<p>Construct the 95% confidence interval for the parameter <span class="math inline">\(\small \mu\)</span> as follows: <span class="math display">\[\left [ \overline{log(x)}- \frac{S_l}{\sqrt
n}t_{0.025}(n-1), \overline{log(x)}+ \frac{S_l}{\sqrt
n}t_{0.025}(n-1)\right ]\]</span></p>
<p><strong><em>step2</em></strong>. Use a Monte Carlo method to obtain
an empirical estimate of the confidence level.</p>
<p>Suppose <span class="math inline">\(\theta\)</span> is the target
parameter to be estimated. <strong><em>1</em></strong>. For each
replicate, indexed <span class="math inline">\(j = 1,...,m\)</span>:</p>
<p><strong><em>(a)</em></strong> Generate the <span class="math inline">\(j^{th}\)</span> random sample, <span class="math inline">\(X^{(j)}_1 ,...,X^{(j)}_n\)</span> .</p>
<p><strong><em>(b)</em></strong> Compute the confidence interval <span class="math inline">\(C_j\)</span> for the <span class="math inline">\(j^{th}\)</span> sample.</p>
<p><strong><em>(c)</em></strong> Compute <span class="math inline">\(y_j
= I(θ \in C_j )\)</span> for the <span class="math inline">\(j^{th}\)</span> sample.</p>
<p><strong><em>2</em></strong>. Compute the empirical confidence level
<span class="math inline">\(\bar y=\frac{1}{m}\sum_{j=1}^{m}y_j\)</span>
.</p>
<p><strong><em>step3</em></strong>. Achieve step2 with R.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#options(warn = -1)</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">109</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> .<span class="dv">05</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>UCL <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="at">expr =</span> {</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">rlnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>) <span class="co">#set parameter meanlog = 0, sdlog = 1.</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sqrt</span>(n)<span class="sc">*</span><span class="fu">abs</span>(<span class="fu">mean</span>(<span class="fu">log</span>(x)))<span class="sc">/</span><span class="fu">var</span>(<span class="fu">log</span>(x))<span class="sc">/</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> n<span class="dv">-1</span>, <span class="at">lower.tail =</span> F)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>} )</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(UCL<span class="sc">&lt;=</span><span class="dv">1</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.952</span></span></code></pre></div>
<p>We see that the empirical estimate of the confidence level with a
Monte Carlo method is 95.2%, which is consistent with the theoretical
value 95%.</p>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
<div id="question42ans" class="section level3">
<h3>Question 2</h3>
<p><strong><em>step1</em></strong>. Repeat the simulation in Example
6.16, but also compute the F test of equal variance, at significance
level <span class="math inline">\(\hat \alpha \doteq 0.055\)</span></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co">#define the function to give the result of different tests and sample sizes.</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>Q2test <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a> <span class="co"># generate samples under H1 to estimate power</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a> m <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a> sigma1 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a> sigma2 <span class="ot">=</span> <span class="fl">1.5</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a> alpha <span class="ot">=</span> <span class="fl">0.055</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a> power <span class="ot">=</span> <span class="fu">replicate</span>(m, <span class="at">expr=</span>{</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a> x <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma1)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a> y <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma2)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a> <span class="fu">c</span>(<span class="fu">count5test</span>(x,y),<span class="fu">as.integer</span>(<span class="fu">var.test</span>(x,y)<span class="sc">$</span>p.value <span class="sc">&lt;=</span> alpha))</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a> })</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">mean</span>(power[<span class="dv">1</span>,]),<span class="fu">mean</span>(power[<span class="dv">2</span>,])))</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong><em>step2</em></strong>. Compare the power of the Count Five
test and F test for small, medium, and large sample sizes.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">109</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>resultQ2 <span class="ot">=</span> <span class="fu">lapply</span>(<span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>),Q2test)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">#to show the result in the form of table.</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>re_t <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">unlist</span>(resultQ2),<span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(re_t) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Count Five Test&quot;</span>,<span class="st">&quot;F test&quot;</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(re_t) <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(re_t, <span class="at">caption =</span> </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;the Power of the Count Five Test and F Test </span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="st">      for Different Sample Sizes.&quot;</span>)</span></code></pre></div>
<table>
<caption>the Power of the Count Five Test and F Test for Different
Sample Sizes.</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">10</th>
<th align="right">100</th>
<th align="right">1000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Count Five Test</td>
<td align="right">0.111</td>
<td align="right">0.856</td>
<td align="right">0.996</td>
</tr>
<tr class="even">
<td align="left">F test</td>
<td align="right">0.202</td>
<td align="right">0.972</td>
<td align="right">1.000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Compare by standard values.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>re_t<span class="fl">.1</span> <span class="ot">=</span> (re_t[<span class="dv">2</span>,]<span class="sc">-</span>re_t[<span class="dv">1</span>,])<span class="sc">/</span>re_t[<span class="dv">1</span>,]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>re_t<span class="fl">.2</span> <span class="ot">=</span> (re_t[<span class="dv">2</span>,]<span class="sc">-</span>re_t[<span class="dv">1</span>,])<span class="sc">/</span>re_t[<span class="dv">2</span>,]</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>gap_t <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">data.frame</span>(re_t<span class="fl">.1</span>,re_t<span class="fl">.2</span>),<span class="dv">3</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(gap_t) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;gap/Count5test&quot;</span>,<span class="st">&quot;gap/Ftest&quot;</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(gap_t, <span class="at">caption =</span> </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;the standard gap of Power of the Count Five Test </span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="st">      and F Test for Different Sample Sizes.&quot;</span>)</span></code></pre></div>
<table>
<caption>the standard gap of Power of the Count Five Test and F Test for
Different Sample Sizes.</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">gap/Count5test</th>
<th align="right">gap/Ftest</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">10</td>
<td align="right">0.820</td>
<td align="right">0.450</td>
</tr>
<tr class="even">
<td align="left">100</td>
<td align="right">0.136</td>
<td align="right">0.119</td>
</tr>
<tr class="odd">
<td align="left">1000</td>
<td align="right">0.004</td>
<td align="right">0.004</td>
</tr>
</tbody>
</table>
<p>The power of the Count Five test and F test get bigger and closer
with the sample size rising. When the sample size get to big enough, the
two are all close to 1.</p>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
<div id="question43ans" class="section level3">
<h3>Question 3</h3>
<p><strong><em>step1</em></strong>. We can’t say the powers are
different at 0.05 level, suppose with method k, <span class="math inline">\(P_k = P_{H_a}(p-value_k\le\alpha)\)</span>, Then
<span class="math inline">\(I_{H_a}(p-value_k\le\alpha) \sim
Binomial(1,P_k)\)</span>, the estimation of the power with Monte Carlo
method is <span class="math display">\[\frac{1}{m}\sum_{j=1}^{m}I_{H_a}(p_j^k\le\alpha),\]</span>
where <span class="math inline">\(p_j^k\)</span> represent p-value of
method k in <span class="math inline">\(j^{th}\)</span> test. if we
obtain the powers for two methods under a particular simulation setting
with 10,000 experiments: say, 0.651 for one method and 0.676 for another
method, we need to use some sort of a test to verify if these two
samples have the same expectations with knowing that the samples follow
the binomial distribution. However, the information we know now are not
enough to do any test for it.</p>
<p><strong><em>step2</em></strong>. Corresponding hypothesis test
problem,</p>
<p><span class="math inline">\(H_0 : P_1=P_2 \longleftrightarrow H_a :
P_1 \ne P_2\)</span></p>
<p><strong><em>step3</em></strong>. We could not use them all with
current information, but with more we could use paired-t test and
McNemar test, reasons are as follows:</p>
<p><strong>Z-test</strong>: the two samples <span class="math inline">\(I_{H_a}(p_j^k\le\alpha),j=1,...,n\)</span> for
k=1,2 need to be independent, which is actually not since they are test
results from same data.</p>
<p><strong>two-sample t-test</strong>: the two samples <span class="math inline">\(I_{H_a}(p_j^k\le\alpha),j=1,...,n\)</span> for
k=1,2 need to be independent, which is actually not since they are test
results from same data.</p>
<p><strong>paired-t test</strong>: we need to know every sample in two
methods.</p>
<p><strong>McNemar test</strong>: we need to almost know every sample
since we need to know the cross frequency table. In fact, McNemar test
is the special form of paired-t test in specific ocasion.</p>
<p><strong><em>step4</em></strong>. The least necessary information for
hypothesis testing:</p>
<p>Sample <span class="math inline">\(I_{H_a}(p_j^k\le\alpha),j=1,...,n\)</span> for
every method k.</p>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
</div>
<div id="HW5" class="section level2">
<h2>HW5</h2>
<hr />
<div id="question51ans" class="section level3">
<h3>Question 1</h3>
<p><strong><em>step1</em></strong>. Assume that the times between
failures follow an exponential model <span class="math inline">\(\small
Exp(\lambda)\)</span>. Obtain the MLE of the hazard rate <span class="math inline">\(\small \lambda\)</span>.</p>
<p>Likelihood function: <span class="math display">\[L(\lambda)=\Pi_{i=1}^n\lambda e^{-\lambda
x_i}I_{[0,\infty)}(x_i)\]</span> Log-likelihood function: <span class="math display">\[l(\lambda)=nlog(\lambda)-\lambda\sum_{i=1}^n
x_i\]</span> <span class="math display">\[\frac{\partial l}{\partial
\lambda}=\frac{n}{\lambda}-\sum_{i=1}^nx_i\]</span> <span class="math display">\[\hat \lambda_{MLE}=\frac{1}{\bar x}\approx
0.09\]</span></p>
<p><strong><em>step2</em></strong>. Use bootstrap to estimate the bias
and standard error of the estimate.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 载入程辑包：&#39;boot&#39;</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:VGAM&#39;:</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     logit, simplex</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 载入程辑包：&#39;dplyr&#39;</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:stats&#39;:</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     filter, lag</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(aircondit)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">=</span> aircondit<span class="sc">$</span>hours</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>MLE_Q1 <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(data1)</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1014</span>)</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>MLE <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) {</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x[i])</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">=</span> <span class="fu">boot</span>(<span class="at">data =</span> data1, <span class="at">statistic =</span> MLE, <span class="at">R =</span> <span class="fl">1e4</span>)</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>result_Q1 <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original.MLE=</span>obj<span class="sc">$</span>t0,<span class="at">bias=</span><span class="fu">mean</span>(obj<span class="sc">$</span>t)<span class="sc">-</span>obj<span class="sc">$</span>t0,</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="at">se=</span><span class="fu">sd</span>(obj<span class="sc">$</span>t)),<span class="dv">3</span>)</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">data.frame</span>(result_Q1),<span class="at">caption =</span> <span class="st">&quot;MLE of the Hazard Rate, Bias</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a><span class="st">and Standard Error of the Estimate&quot;</span>)</span></code></pre></div>
<table>
<caption>MLE of the Hazard Rate, Bias and Standard Error of the
Estimate</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">result_Q1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">original.MLE</td>
<td align="right">0.009</td>
</tr>
<tr class="even">
<td align="left">bias</td>
<td align="right">0.001</td>
</tr>
<tr class="odd">
<td align="left">se</td>
<td align="right">0.004</td>
</tr>
</tbody>
</table>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
<div id="question52ans" class="section level3">
<h3>Question 2</h3>
<p><strong><em>step1</em></strong>. Compute 95% bootstrap confidence
intervals for the mean time between failures <span class="math inline">\(\small 1/\lambda\)</span> by the standard normal,
basic, percentile, and BCa methods.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1014</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>boot.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>de <span class="ot">&lt;-</span> boot<span class="sc">::</span><span class="fu">boot</span>(<span class="at">data =</span> data1,<span class="at">statistic =</span> boot.mean, <span class="at">R =</span> <span class="fl">1e4</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>ci</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Based on 10000 bootstrap replicates</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; CALL : </span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; boot.ci(boot.out = de, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, &quot;bca&quot;))</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Intervals : </span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Level      Normal              Basic         </span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95%   ( 33.7, 181.9 )   ( 23.7, 169.6 )  </span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Level     Percentile            BCa          </span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95%   ( 46.6, 192.5 )   ( 56.6, 223.6 )  </span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Calculations and Intervals on Original Scale</span></span></code></pre></div>
<p><strong><em>step2</em></strong>. Compare the intervals and explain
why they may differ.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compare the length of intervals.</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>len.basic <span class="ot">=</span> ci<span class="sc">$</span>basic[<span class="dv">5</span>]<span class="sc">-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span>]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>len.bca <span class="ot">=</span> ci<span class="sc">$</span>bca[<span class="dv">5</span>]<span class="sc">-</span>ci<span class="sc">$</span>bca[<span class="dv">4</span>]</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>len.perc <span class="ot">=</span> ci<span class="sc">$</span>percent[<span class="dv">5</span>]<span class="sc">-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span>]</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>len.normal <span class="ot">=</span> ci<span class="sc">$</span>normal[<span class="dv">3</span>]<span class="sc">-</span>ci<span class="sc">$</span>normal[<span class="dv">2</span>]</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>result_Q2 <span class="ot">=</span> <span class="fu">cbind</span>(len.normal,len.basic,len.perc,len.bca)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(result_Q2,<span class="at">caption =</span> <span class="st">&quot;Interval Length of Different Methods&quot;</span>)</span></code></pre></div>
<table>
<caption>Interval Length of Different Methods</caption>
<thead>
<tr class="header">
<th align="right">len.normal</th>
<th align="right">len.basic</th>
<th align="right">len.perc</th>
<th align="right">len.bca</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">148.1998</td>
<td align="right">145.9146</td>
<td align="right">145.9146</td>
<td align="right">167.0194</td>
</tr>
</tbody>
</table>
<p>We see that the lengths of intervals with percentile and basic
methods are totally same, method BCa got the biggest length of interval.
From another angle, if we look at the whole interval, we could see that
as using method normal, basic, percentile and BCa respectively,
confidence interval are moving to the right.</p>
<p>Explanation: for the first phenomenon, method basic and percentile
both got a theoretical confidence interval length <span class="math inline">\(\small \hat \theta_{1-\alpha/2}-\hat
\theta_{\alpha/2}\)</span>, in which the sample <span class="math inline">\(\small \alpha\)</span> quantiles <span class="math inline">\(\small \hat \theta_\alpha\)</span> is computed
from the ecdf of the replicates <span class="math inline">\(\small \hat
\theta^\ast\)</span>. For the second phenomenon, we need to show the
interval centers with those four methods:</p>
<p><span class="math display">\[\left\{\begin{matrix}
   2\hat \theta-\frac{\hat \theta_{\alpha/2}+\hat
\theta_{1-\alpha/2}}{2} &amp; Basic \\
\hat \theta &amp; Normal\\
  \frac{\hat \theta_{\alpha/2}+\hat \theta_{1-\alpha/2}}{2}&amp;
Percentile\\
  \frac{\hat \theta_{\alpha_1}+\hat \theta_{\alpha_2}}{2}&amp;BCa\\
\end{matrix}\right.\]</span></p>
<p>One more thing, show the histogram of source data.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data1,<span class="at">breaks =</span> <span class="dv">100</span>,<span class="at">main =</span> <span class="st">&quot;Histogram of source data&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;times in hours between failures&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>With the information above, let’s explain the second phenomenon:
first, <span class="math inline">\(\small \hat \theta\)</span> is the
mean of source data, at the same time, we assume that the times between
failures follow an exponential model <span class="math inline">\(\small
Exp(\lambda)\)</span>, with the histogram above and the density of <span class="math inline">\(\small Exp(\lambda)\)</span>, we could know that
the greater the time between failure, the smaller the probability of
occurrence, which make the estimate of sample <span class="math inline">\(\small \alpha/2\)</span> quantiles <span class="math inline">\(\small \hat \theta_{\alpha/2}\)</span> on the very
right position and directly make the mean of them <span class="math inline">\(\small \frac{\hat \theta_{\alpha/2}+\hat
\theta_{1-\alpha/2}}{2}\)</span> bigger than <span class="math inline">\(\small \hat \theta\)</span>, which is the mean of
source data. that cause interval center of method percentile bigger than
method normal, and so as method normal and method basic. As for the
method BCa, we see it from the result 7.4 that the bias is positive
which make the modification of method BCa is to the right.</p>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
<div id="question53ans" class="section level3">
<h3>Question 3</h3>
<p><strong><em>step1</em></strong>. Generate sample from a normal
population and show the 95% confidence interval of method normal, basic
and percentile.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1014</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>n_Q3 <span class="ot">=</span> <span class="fl">1e3</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Generate 1000 sample from a normal population with parameter mu=0,sigma=1.</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">=</span> <span class="fu">rnorm</span>(n_Q3) </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>de <span class="ot">&lt;-</span> boot<span class="sc">::</span><span class="fu">boot</span>(<span class="at">data =</span> sample,<span class="at">statistic =</span> boot.mean, <span class="at">R =</span> <span class="fl">1e4</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">#show the confidence interval of method normal, basic and percentile.</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>ci</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Based on 10000 bootstrap replicates</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; CALL : </span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; boot.ci(boot.out = de, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;))</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Intervals : </span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Level      Normal              Basic              Percentile     </span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95%   (-0.0580,  0.0657 )   (-0.0572,  0.0650 )   (-0.0563,  0.0659 )  </span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Calculations and Intervals on Original Scale</span></span></code></pre></div>
<p><strong><em>step2</em></strong>. Check the empirical coverage rates
for the sample mean. Find the proportion of times that the confidence
intervals miss on the left, and the proportion of times that the
confidence intervals miss on the right.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> <span class="dv">0</span> <span class="co">#true value of mean.</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">5</span><span class="sc">*</span><span class="fl">1e1</span> <span class="co">#sample num.</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fl">1e2</span> <span class="co">#num to calculate cover rate.</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1014</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci.basic<span class="ot">&lt;-</span>ci.perc<span class="ot">&lt;-</span>ci.bca<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">=</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>de <span class="ot">=</span> boot<span class="sc">::</span><span class="fu">boot</span>(<span class="at">data=</span>sample,<span class="at">statistic=</span>boot.mean, <span class="at">R =</span> <span class="dv">999</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">=</span> boot<span class="sc">::</span><span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>ci.norm[i,] <span class="ot">=</span> ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>ci.basic[i,] <span class="ot">=</span> ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>ci.perc[i,] <span class="ot">=</span> ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>cover <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu))</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>left <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="sc">&lt;=</span>mu),<span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="sc">&lt;=</span>mu),<span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="sc">&lt;=</span>mu))</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>right <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&gt;=</span>mu),<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&gt;=</span>mu),<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&gt;=</span>mu))</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="co">#codes below are to show the results in the form of table.</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>result_Q3 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(cover,left,right),<span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(result_Q3) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Nomal&quot;</span>,<span class="st">&quot;Basic&quot;</span>,<span class="st">&quot;Percentile&quot;</span>)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_Q3) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;in&quot;</span>,<span class="st">&quot;left&quot;</span>,<span class="st">&quot;right&quot;</span>)</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(result_Q3,<span class="at">caption =</span> <span class="st">&quot;Sample Mean Cover Rate in Different Position of 95% Confidence Intervals with Different Methods&quot;</span>)</span></code></pre></div>
<table>
<caption>Sample Mean Cover Rate in Different Position of 95% Confidence
Intervals with Different Methods</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">in</th>
<th align="right">left</th>
<th align="right">right</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Nomal</td>
<td align="right">0.95</td>
<td align="right">0.04</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">Basic</td>
<td align="right">0.95</td>
<td align="right">0.03</td>
<td align="right">0.02</td>
</tr>
<tr class="odd">
<td align="left">Percentile</td>
<td align="right">0.96</td>
<td align="right">0.03</td>
<td align="right">0.01</td>
</tr>
</tbody>
</table>
<p>We see that the empirical coverage rates for the sample mean with
these three methods are all close to 0.95, which actually equals to
<span class="math inline">\(1-\alpha\)</span>, the proportion of times
that the confidence intervals miss on the left and on the right are not
same, which are all more on the left.</p>
<hr />
</div>
</div>
<div id="HW6" class="section level2">
<h2>HW6</h2>
<hr />
<div id="question61ans" class="section level3">
<h3>Question 1</h3>
<p><strong><em>step1</em></strong>. We know that if <span class="math inline">\(\small X_1,X_2,...,X_n \sim
N(\boldsymbol{\mu},\Sigma)\)</span>, the MLE of <span class="math inline">\(\small \Sigma\)</span> is: <span class="math display">\[\small \frac{1}{n}\sum_{i=1}^{n}(X_i-\bar
X)(X_i-\bar X)^{&#39;}.\]</span></p>
<p>Now we assume that the data follows a multivariate normal
distribution, in fact, since n=88 is big enough (commonly <span class="math inline">\(\small n \ge30\)</span> or <span class="math inline">\(\small n\ge 50\)</span> is required) . So this
assumption is reasonable. Then we start to compute the MLE of <span class="math inline">\(\small \Sigma\)</span> and eigenvalues of it , say
<span class="math inline">\(\small \hat \lambda_i,\qquad
i=1,2,3,4,5\)</span></p>
<p>With exercise 7.7, <span class="math display">\[\hat
\theta=\frac{\hat \lambda_1}{\sum_{i=1}^{5}\hat \lambda_i},\]</span></p>
<p>where <span class="math inline">\(\hat \lambda_1&gt;\hat
\lambda_2&gt;...&gt;\hat \lambda_5.\)</span></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 载入程辑包：&#39;bootstrap&#39;</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:VGAM&#39;:</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     hormone</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scor)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>data_Q1 <span class="ot">=</span> <span class="fu">data.frame</span>(scor)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_Q1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Mechanics&quot;</span>,<span class="st">&quot;Vectors&quot;</span>,<span class="st">&quot;Algebra&quot;</span>,<span class="st">&quot;Analysis&quot;</span>,<span class="st">&quot;Statistic&quot;</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>n_Q1 <span class="ot">=</span> <span class="fu">dim</span>(data_Q1)[<span class="dv">1</span>]</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co">#define function to compute MLE of Sigma and it&#39;s engenvalues.</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>MLE_theta <span class="ot">&lt;-</span> <span class="cf">function</span>(data,n){</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#compute the MLE of Sigma.</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  var_mle <span class="ot">=</span> (n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">*</span><span class="fu">var</span>(data)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#compute estimation of theta.</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  lam <span class="ot">=</span> <span class="fu">eigen</span>(var_mle)<span class="sc">$</span>values</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  theta.hat <span class="ot">=</span> lam[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lam)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(theta.hat)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong><em>step2</em></strong>. Now use Jackknife to estimate the
bias and standard error of <span class="math inline">\(\small \hat
\theta\)</span></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">=</span> <span class="fu">MLE_theta</span>(data_Q1,n_Q1)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>theta.jack <span class="ot">=</span> <span class="fu">numeric</span>(n_Q1)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_Q1){</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>theta.jack[i] <span class="ot">&lt;-</span> <span class="fu">MLE_theta</span>(data_Q1[(<span class="dv">1</span><span class="sc">:</span>n_Q1)[<span class="sc">-</span>i],],n_Q1<span class="dv">-1</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>bias.jack <span class="ot">=</span> (n_Q1 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta.jack) <span class="sc">-</span> theta.hat)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>se.jack <span class="ot">=</span> <span class="fu">sqrt</span>((n_Q1 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">mean</span>((theta.jack <span class="sc">-</span> theta.hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co">#codes below are to show the result in the form of table.</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>result_Q1 <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original_theta_hat =</span> theta.hat,</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">bias.jack =</span> bias.jack, <span class="at">se.jack =</span> se.jack),<span class="dv">3</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">data.frame</span>(result_Q1), </span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="at">caption =</span> <span class="st">&quot;Estimation of Theta, Bias and Standard Error of the Estimate with Jackknife&quot;</span>)</span></code></pre></div>
<table>
<caption>Estimation of Theta, Bias and Standard Error of the Estimate
with Jackknife</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">result_Q1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">original_theta_hat</td>
<td align="right">0.619</td>
</tr>
<tr class="even">
<td align="left">bias.jack</td>
<td align="right">0.001</td>
</tr>
<tr class="odd">
<td align="left">se.jack</td>
<td align="right">0.050</td>
</tr>
</tbody>
</table>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
<div id="question62ans" class="section level3">
<h3>Question 2</h3>
<p><strong><em>step1</em></strong>. Copy the codes of Example 7.8 and
Example 7.7 from text book, and modify it to use leave-two-out cross
validation.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG); <span class="fu">attach</span>(ironslag)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, .<span class="dv">1</span>) <span class="co">#sequence for plotting fits</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">#creat models.</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co">#L1 &lt;- lm(magnetic ~ chemical)</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co">#L2 &lt;- lm(magnetic ~ chemical + I(chemical^2))</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co">#L3 &lt;- lm(log(magnetic) ~ chemical)</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co">#L4 &lt;- lm(log(magnetic) ~ log(chemical))</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n,n)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models on leave-one-out samples</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span>n)[<span class="sc">-</span>k]) {</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span><span class="fu">c</span>(k,j)]</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span><span class="fu">c</span>(k,j)]</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>    yhat1<span class="fl">.1</span> <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>    yhat1<span class="fl">.2</span> <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[j]</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>    e1[k,j] <span class="ot">&lt;-</span> ((magnetic[k] <span class="sc">-</span> yhat1<span class="fl">.1</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(magnetic[j] <span class="sc">-</span> yhat1<span class="fl">.2</span>)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>    J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>    yhat2<span class="fl">.1</span> <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>    J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>    yhat2<span class="fl">.2</span> <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[j] <span class="sc">+</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>    J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[j]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>    e2[k,j] <span class="ot">&lt;-</span> ((magnetic[k] <span class="sc">-</span> yhat2<span class="fl">.1</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(magnetic[j] <span class="sc">-</span> yhat2<span class="fl">.2</span>)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>    J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>    logyhat3<span class="fl">.1</span> <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>    yhat3<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3<span class="fl">.1</span>)</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>    logyhat3<span class="fl">.2</span> <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[j]</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>    yhat3<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3<span class="fl">.2</span>)</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>    e3[k,j] <span class="ot">&lt;-</span> ((magnetic[k] <span class="sc">-</span> yhat3<span class="fl">.1</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(magnetic[j] <span class="sc">-</span> yhat3<span class="fl">.2</span>)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>    J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>    logyhat4<span class="fl">.1</span> <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[k])</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>    logyhat4<span class="fl">.2</span> <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[j])</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>    yhat4<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4<span class="fl">.1</span>)</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>    yhat4<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4<span class="fl">.2</span>)</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>    e4[k,j] <span class="ot">&lt;-</span> ((magnetic[k] <span class="sc">-</span> yhat4<span class="fl">.1</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(magnetic[j] <span class="sc">-</span> yhat4<span class="fl">.2</span>)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(ironslag)</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a><span class="co">#codes below are to show the result in the form of table.</span></span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>result_Q2<span class="ot">=</span><span class="fu">c</span>(<span class="fu">sum</span>(e1)<span class="sc">/</span>(n<span class="sc">*</span>(n<span class="dv">-1</span>)), </span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>            <span class="fu">sum</span>(e2)<span class="sc">/</span>(n<span class="sc">*</span>(n<span class="dv">-1</span>)), <span class="fu">sum</span>(e3)<span class="sc">/</span>(n<span class="sc">*</span>(n<span class="dv">-1</span>)), <span class="fu">sum</span>(e4)<span class="sc">/</span>(n<span class="sc">*</span>(n<span class="dv">-1</span>)))</span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a>table_Q2 <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">matrix</span>(result_Q2),<span class="dv">3</span>)</span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table_Q2) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Model1&quot;</span>,<span class="st">&quot;Model2&quot;</span>,<span class="st">&quot;Model3&quot;</span>,<span class="st">&quot;Model4&quot;</span>)</span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table_Q2) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;estimates for prediction error&quot;</span>)</span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(table_Q2,</span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Estimates for Prediction Error of Different Models&quot;</span>)</span></code></pre></div>
<table>
<caption>Estimates for Prediction Error of Different Models</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">estimates for prediction error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Model1</td>
<td align="right">19.572</td>
</tr>
<tr class="even">
<td align="left">Model2</td>
<td align="right">17.870</td>
</tr>
<tr class="odd">
<td align="left">Model3</td>
<td align="right">18.455</td>
</tr>
<tr class="even">
<td align="left">Model4</td>
<td align="right">20.467</td>
</tr>
</tbody>
</table>
<p><strong><em>step2</em></strong>. Compare the result above with using
leave-one-out cross validation, which we got from text book.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>result_Q2.one <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">19.55644</span>, <span class="fl">17.85248</span>, <span class="fl">18.44188</span>, <span class="fl">20.45424</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>differ <span class="ot">=</span> result_Q2 <span class="sc">-</span> result_Q2.one</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(result_Q2,result_Q2.one,differ),<span class="at">nrow =</span> <span class="dv">4</span>),<span class="dv">3</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co">#codes below are to show the result in the form of table.</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(comparison) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;leave-two-out&quot;</span>,<span class="st">&quot;leave-one-out&quot;</span>,<span class="st">&quot;difference&quot;</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(comparison) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Model1&quot;</span>,<span class="st">&quot;Model2&quot;</span>,<span class="st">&quot;Model3&quot;</span>,<span class="st">&quot;Model4&quot;</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(comparison,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Estimates for Prediction Error of Different Models&quot;</span>)</span></code></pre></div>
<table>
<caption>Estimates for Prediction Error of Different Models</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">leave-two-out</th>
<th align="right">leave-one-out</th>
<th align="right">difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Model1</td>
<td align="right">19.572</td>
<td align="right">19.556</td>
<td align="right">0.016</td>
</tr>
<tr class="even">
<td align="left">Model2</td>
<td align="right">17.870</td>
<td align="right">17.852</td>
<td align="right">0.018</td>
</tr>
<tr class="odd">
<td align="left">Model3</td>
<td align="right">18.455</td>
<td align="right">18.442</td>
<td align="right">0.013</td>
</tr>
<tr class="even">
<td align="left">Model4</td>
<td align="right">20.467</td>
<td align="right">20.454</td>
<td align="right">0.013</td>
</tr>
</tbody>
</table>
<p>We see that with the methods of leave-one-out and leave-two-out cross
validation, model 2 is the best with least prediction error, and these
two methods are not seemed to have a big difference under this certain
data.</p>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
<div id="question63ans" class="section level3">
<h3>Question 3</h3>
<p><strong><em>step1</em></strong>. Implement the bivariate Spearman
rank correlation test for independence as a permutation test.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 载入程辑包：&#39;MASS&#39;</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:DAAG&#39;:</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     hills</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:dplyr&#39;:</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     select</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1021</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co">#generate data by multi-normal distribution.</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>data_Q3 <span class="ot">=</span> <span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">10</span>,<span class="at">mu =</span> mu,<span class="at">Sigma =</span> sigma, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>x_Q3 <span class="ot">=</span> data_Q3[,<span class="dv">1</span>];y_Q3 <span class="ot">=</span> data_Q3[,<span class="dv">2</span>]</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>n_Q3 <span class="ot">=</span> <span class="fu">length</span>(x_Q3)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>R <span class="ot">=</span> <span class="dv">999</span> <span class="co">#number of replicates</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">=</span> <span class="fu">numeric</span>(R) <span class="co">#storage for replicates</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">=</span> <span class="fu">cor</span>(x_Q3, y_Q3, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="co">#generate indices k for y.</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n_Q3, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">=</span> x_Q3</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">=</span> y_Q3[k] <span class="co">#complement of x1</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>reps[i] <span class="ot">=</span> <span class="fu">cor</span>(x1, y1, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>p_per <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(reps) <span class="sc">&gt;=</span> <span class="fu">abs</span>(t0))</span></code></pre></div>
<p><strong><em>step2</em></strong>. Compare the achieved significance
level of the permutation test with the p-value reported by cor.test on
the same samples.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>p_int <span class="ot">=</span> <span class="fu">cor.test</span>(x_Q3, y_Q3, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>, <span class="at">exact=</span><span class="cn">FALSE</span>)<span class="sc">$</span>p.value</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>result_Q3 <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(p_int,p_per)),<span class="dv">3</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(result_Q3) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;pure cor.test&quot;</span>,<span class="st">&quot;permutation test&quot;</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_Q3) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;p-value&quot;</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(result_Q3, <span class="at">table.envir=</span><span class="st">&quot;table*&quot;</span>, </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;p-values of permutation test and pure Spearman rank correlation test&quot;</span>)</span></code></pre></div>
<table>
<caption>p-values of permutation test and pure Spearman rank correlation
test</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">pure cor.test</td>
<td align="right">0.489</td>
</tr>
<tr class="even">
<td align="left">permutation test</td>
<td align="right">0.469</td>
</tr>
</tbody>
</table>
<p>We see that p-value of permutation test is 0.469, which is similar
and a little smaller than the p-value of pure Spearman rank correlation
test ,which is 0.489.</p>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
</div>
<div id="HW7" class="section level2">
<h2>HW7</h2>
<hr />
<div id="question71ans" class="section level3">
<h3>Question 1</h3>
<p><strong><em>step1</em></strong>. Implement a random walk Metropolis
sampler for generating the standard Laplace distribution.</p>
<p>density of Laplace Distribution: <span class="math display">\[f(x) =
\frac{1}{2}e^{−|x|}, x \in R\]</span></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="dv">1</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>rw.Metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(x0, sigma, N){</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Laplace distribution with parameter:loc=0,scale=1;</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#N: length of the chain;</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#x0: initial value</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#sigma:param of normal distribution.</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">numeric</span>(N)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">=</span> x0</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(N)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> (<span class="fu">dlaplace</span>(y,<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">/</span> <span class="fu">dlaplace</span>(x[i<span class="dv">-1</span>],<span class="dv">0</span>,<span class="dv">1</span>)))</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">=</span> y <span class="cf">else</span> {</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">=</span> x[i<span class="dv">-1</span>]</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">=</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">k=</span>k))</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">2000</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">5</span>, <span class="dv">2</span>)</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">=</span> <span class="dv">25</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a><span class="co">#Four chains are generated for different variances sigma^2 of the proposal distribution.</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>rw1 <span class="ot">=</span> <span class="fu">rw.Metropolis</span>(x0, sigma[<span class="dv">1</span>], N)</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>rw2 <span class="ot">=</span> <span class="fu">rw.Metropolis</span>(x0, sigma[<span class="dv">2</span>], N)</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>rw3 <span class="ot">=</span> <span class="fu">rw.Metropolis</span>(x0, sigma[<span class="dv">3</span>], N)</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the four chains. </span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(2,2),oma = c(0, 0, 3, 0)) #display 4 graphs together</span></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>refline <span class="ot">&lt;-</span> <span class="fu">qlaplace</span>(<span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>))</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>rw <span class="ot">&lt;-</span> <span class="fu">cbind</span>(rw1<span class="sc">$</span>x, rw2<span class="sc">$</span>x, rw3<span class="sc">$</span>x)</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rw[,j], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigma[j],<span class="dv">3</span>))),<span class="at">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylim=</span><span class="fu">range</span>(rw[,j]))</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>refline)</span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Random walk Metropolis chains with different variances&quot;</span>, <span class="at">side =</span> <span class="dv">3</span>, <span class="at">line =</span> <span class="dv">0</span>, <span class="at">outer =</span> T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(1,1)) #reset to default</span></span></code></pre></div>
<p><strong><em>step2</em></strong>. Compare the chains generated when
different variances are used for the proposal distribution.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compare with the theoretical quantiles of the target distribution.</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">c</span>(.<span class="dv">05</span>, <span class="fu">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">1</span>), .<span class="dv">95</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">=</span> <span class="fu">qlaplace</span>(a)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>rw <span class="ot">=</span> <span class="fu">cbind</span>(rw1<span class="sc">$</span>x, rw2<span class="sc">$</span>x, rw3<span class="sc">$</span>x)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Discard the burn-in values in the first 500 rows of each chain.</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>mc <span class="ot">=</span> rw[<span class="dv">501</span><span class="sc">:</span>N, ]</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>Qrw <span class="ot">=</span> <span class="fu">apply</span>(mc, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">quantile</span>(x, a))</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>result_Q1<span class="fl">.2</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">cbind</span>(Q, Qrw), <span class="dv">3</span>) </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_Q1<span class="fl">.2</span>) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Q&quot;</span>,<span class="st">&quot;rw1&quot;</span>,<span class="st">&quot;rw2&quot;</span>,<span class="st">&quot;rw3&quot;</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(result_Q1<span class="fl">.2</span>,<span class="at">caption =</span> <span class="st">&quot;Quantiles of Target</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="st">Distribution and Chains&quot;</span>)</span></code></pre></div>
<table>
<caption>Quantiles of Target Distribution and Chains</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Q</th>
<th align="right">rw1</th>
<th align="right">rw2</th>
<th align="right">rw3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">5%</td>
<td align="right">-2.303</td>
<td align="right">23.781</td>
<td align="right">-1.314</td>
<td align="right">-2.186</td>
</tr>
<tr class="even">
<td align="left">10%</td>
<td align="right">-1.609</td>
<td align="right">23.848</td>
<td align="right">-0.937</td>
<td align="right">-1.599</td>
</tr>
<tr class="odd">
<td align="left">20%</td>
<td align="right">-0.916</td>
<td align="right">24.039</td>
<td align="right">-0.559</td>
<td align="right">-0.836</td>
</tr>
<tr class="even">
<td align="left">30%</td>
<td align="right">-0.511</td>
<td align="right">24.305</td>
<td align="right">-0.295</td>
<td align="right">-0.384</td>
</tr>
<tr class="odd">
<td align="left">40%</td>
<td align="right">-0.223</td>
<td align="right">24.487</td>
<td align="right">-0.098</td>
<td align="right">-0.114</td>
</tr>
<tr class="even">
<td align="left">50%</td>
<td align="right">0.000</td>
<td align="right">24.808</td>
<td align="right">0.070</td>
<td align="right">0.089</td>
</tr>
<tr class="odd">
<td align="left">60%</td>
<td align="right">0.223</td>
<td align="right">25.326</td>
<td align="right">0.252</td>
<td align="right">0.279</td>
</tr>
<tr class="even">
<td align="left">70%</td>
<td align="right">0.511</td>
<td align="right">25.538</td>
<td align="right">0.555</td>
<td align="right">0.502</td>
</tr>
<tr class="odd">
<td align="left">80%</td>
<td align="right">0.916</td>
<td align="right">25.674</td>
<td align="right">0.856</td>
<td align="right">0.938</td>
</tr>
<tr class="even">
<td align="left">90%</td>
<td align="right">1.609</td>
<td align="right">25.918</td>
<td align="right">1.351</td>
<td align="right">1.582</td>
</tr>
<tr class="odd">
<td align="left">95%</td>
<td align="right">2.303</td>
<td align="right">26.111</td>
<td align="right">1.745</td>
<td align="right">2.387</td>
</tr>
</tbody>
</table>
<p>We see that RW3 with <span class="math inline">\(\small
\sigma=2\)</span> is the one that most close to target distribution.</p>
<p><strong><em>step3</em></strong>. Compute acceptance rates of each
chain</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#number of candidate points rejected.</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>result_Q1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">data.frame</span>((N<span class="sc">-</span><span class="fu">c</span>(rw1<span class="sc">$</span>k, rw2<span class="sc">$</span>k, rw3<span class="sc">$</span>k))<span class="sc">/</span>N)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(result_Q1<span class="fl">.1</span>) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;rw1&quot;</span>,<span class="st">&quot;rw2&quot;</span>,<span class="st">&quot;rw3&quot;</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_Q1<span class="fl">.1</span>) <span class="ot">=</span> <span class="st">&quot;Acceptance Rate&quot;</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(result_Q1<span class="fl">.1</span>,<span class="at">caption =</span> <span class="st">&quot;Acceptance Rates of</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="st">Each Chain&quot;</span>)</span></code></pre></div>
<table>
<caption>Acceptance Rates of Each Chain</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Acceptance Rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">rw1</td>
<td align="right">0.9840</td>
</tr>
<tr class="even">
<td align="left">rw2</td>
<td align="right">0.8315</td>
</tr>
<tr class="odd">
<td align="left">rw3</td>
<td align="right">0.5280</td>
</tr>
</tbody>
</table>
<p><strong><em>step4</em></strong>. Use the Gelman-Rubin method to
monitor convergence of the chain, and run the chain until it converges
approximately to the target distribution according to <span class="math inline">\(\small \hat R &lt; 1.2\)</span>.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi){</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>x0_GR <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">3</span> <span class="co">#number of chains to generate</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">15000</span> <span class="co">#length of chains</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>GR_R <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>   X[i, ] <span class="ot">=</span> <span class="fu">rw.Metropolis</span>(x0_GR[i],sigma[j],n)<span class="sc">$</span>x</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#compute diagnostic statistics</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">=</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>  GR_R[j] <span class="ot">=</span> <span class="fu">Gelman.Rubin</span>(psi)</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>  rhat <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">=</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>result_Q2<span class="fl">.0</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">data.frame</span>(GR_R),<span class="dv">3</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_Q2<span class="fl">.0</span>) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Gelman Rubin R_hat&quot;</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(result_Q2<span class="fl">.0</span>) <span class="ot">=</span>  <span class="fu">c</span>(<span class="st">&quot;rw1&quot;</span>,<span class="st">&quot;rw2&quot;</span>,<span class="st">&quot;rw3&quot;</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(result_Q2<span class="fl">.0</span>,<span class="at">caption =</span> <span class="st">&quot;Gelman Rubin R_hat for chains with diffenrent variance&quot;</span>)</span></code></pre></div>
<table>
<caption>Gelman Rubin R_hat for chains with diffenrent
variance</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Gelman Rubin R_hat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">rw1</td>
<td align="right">8.214</td>
</tr>
<tr class="even">
<td align="left">rw2</td>
<td align="right">1.140</td>
</tr>
<tr class="odd">
<td align="left">rw3</td>
<td align="right">1.065</td>
</tr>
</tbody>
</table>
<p>As the variance becomes larger, the convergence get faster.</p>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
<div id="question72ans" class="section level3">
<h3>Question 2</h3>
<p><strong><em>step1</em></strong>. Implement a Gibbs sampler to
generate a bivariate normal chain <span class="math inline">\(\small
(X_t, Y_t)\)</span> with zero means, unit standard deviations, and
correlation 0.9. Plot the generated sample after discarding a suitable
burn-in sample.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize constants and parameters</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">=</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">=</span> <span class="fl">0.9</span> <span class="co">#correlation</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the chain</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">=</span> <span class="fu">c</span>(mu1, mu2) <span class="co">#initialize</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>Gibbs.ch <span class="ot">&lt;-</span> <span class="cf">function</span>(N,sigma1,sigma2,mu1,mu2,s1,s2,X){</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">=</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">=</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">=</span> X[i, <span class="dv">1</span>]</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">=</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">2</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">Gibbs.ch</span>(N,sigma1,sigma2,mu1,mu2,s1,s2,X)</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(X[t]),<span class="at">ylab=</span><span class="fu">bquote</span>(Y[t]), <span class="at">ylim=</span><span class="fu">range</span>(x[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong><em>step2</em></strong>. Fit a simple linear regression model
<span class="math inline">\(\small Y = β_0 + β_1X\)</span> to the sample
and check the residuals of the model for normality and constant
variance.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(x) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>,<span class="st">&quot;Y&quot;</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>model.lm <span class="ot">=</span> <span class="fu">lm</span>(Y<span class="sc">~</span>X,<span class="at">data =</span> <span class="fu">data.frame</span>(x))</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model.lm)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = Y ~ X, data = data.frame(x))</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -1.50298 -0.29280 -0.00625  0.29130  1.69813 </span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.009991   0.006832  -1.462    0.144    </span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X            0.907791   0.006931 130.972   &lt;2e-16 ***</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.4317 on 3998 degrees of freedom</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.811,  Adjusted R-squared:  0.8109 </span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 1.715e+04 on 1 and 3998 DF,  p-value: &lt; 2.2e-16</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model.lm)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABEVBMVEUAAAAAAA0AABcAACEAACgAACoAADIAADoAAFgAAGYAKJAAOjoAOpAAWGYAZrYNAAAXAAAXZrYgMZAxAAAyAAA6AAA6ADo6AGY6KAA6KDo6KGY6Ojo6OmY6OpA6SQA6Zlg6kLY6kNtJtv9RMQBRfGZYAABYZjpYtv9mAABmABdmAChmADpmAGZmOgBmOpBmZmZmgWZmkJBmtrZmtv9m2/982/+B//+QMgCQOgCQOjqQZgCQkGaQnWaQtv+QvJCQ27aQ29uQ2/+2WAC2ZgC2tma225C2/7a2//+8kDq+vr7bfCHbkDrbtmbb25Db/7bb///fU2v/gSj/tkn/tmb/trb/vFH/22b/25D//7b//9v///9zrUrUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAASPUlEQVR4nO1diZ/jNhUWFBgGhqEUplwtkHINbEthwjFLgZK6B4tLZ2mATPT//yFY0tPTky37ybKcOBl9v93EjmVZ/kbv0PmELBiEOHYBlo5CEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEINCEANH0OPtStZCXD0csTQLhCOounrY3VzL6vqIpVkgkKDH27Xciub/5SfHLM/i4BFUNeTUhSAPRMSuH2+vHh5vi4h5oEpaXGz294UfH7OY+f290FgFrilRNthebAau9qI6rJ2diSBdD5XOH0AhiJHXUyKo0T+IDFbMMqPfpQZZ2900B2ugoPnx4r2LjT7RH5W+qI8hob5FfTVEup8oQSZnTGSf9PjsPfUSlb2lMs9yJRmF2WtQ3RRtdwPv0QidoaN5ga0gBFWQsjm2CTGf6upf7idCEORsEz3YJyljLDFHfBaWZBzmJKjWFUaVqPE+rQNq6oh618oR9PhsY+pLc0w9VeWUNTl4zqslCHOGRHiuDzBH8iy4Pu5dPDOfT8RMVmuraJpSPt6ajLXHrg+3VMRUDTECaBNiYpWMFMoSRHLWibxziTnis/D6uHfx2mL19fgMQtA1SDXsdCGBK82a0UF1h6BGPVx+ZGqQTWgKda0J8X6yBGHOJhGeo5bTOeKzXPpRIE2Nldw2z64zGAkjYlulEX1TBVLVqUH6zwIiZhPq7+3lx7Y+2J/8GuQS4bnOA3Ns1aDR8Npiu+9+ov9PBeigymhdckFLkNULNeiF5ky/xVY4gtz3u1a6kDvUQWvM9V2thtYkIeZInpUkG0jQ/n6lNVtGgrQ5MZYE/oC20qgft7plc/XQiM/aVB6x0koaEpqsKnENZ9tWDcKcIRGeYw3SOfpWDOvheIK0sFarjCKm9MDKeB/mzykEVinwg7RluDM66GJjBdAkNDDGnf5UYTPG5mw9ADh3T9gAfeLyQ5UO048BMfONrmvKe569Hem9XGffJ611kPGBknD2BBl3IN13IVYsX1vsnNCuQaVLuoWOiJVRDR8dgkoV8tEhaNqohjgZpBI0cVTjZIzieIKsFZvmSJ8xQTmf+yJvpnOgEMRgJEHZOu3PWcR0/1ZwLGaO5x4b4wnCLopJWvpcRUy6DroIR3Gg3zqeoBGuyBxIqUGmR2Bg4DJCU4167jEZStJB0Hnbn9ioKb4GxT72iAylmHldQYY1kBm07BLU8uB5ETtJgqJQ6fHbyTrofAlSHfEZROwUdVAsdjdfTyfI2a7TsmJ67D/Wk1YDWcPZ9YqYYmUZvuSC2mKkqgh59JpjcVyC2r/Ar4oasRCGEgjKshSh81xqrox8LUPKEgjKshShI2ICnCRzbOrQaRKUZylCgCBhxMroZ0OVoUscUyWlETR9KUJIB1GGCD9w7Uj1KUXEcixFCBCkSbH0EHEjn0eoRUlKOsNShK6ZpyMt1KK5T3EMrbQcP8ixQ1iiBB1HzhbjB9F2PmhlTEl+PQmCGhm7eqiSJ9KEn+vVHo8Kp5uCN86MlA6zi02tlPQkhtoi1h3vdfXJ3nAUSzaeINXlqjrsc5j5EEGSHlnNM7J5ltHcpflBiqAcjiI578JzrkdVnZxVLb0GTVttNEiQdARJ5zO6ahE66uTd/2b7e5gJu79fk6+4gkYkNDqonjCdTw6JWBhOJWEF8VRUN+/+N6vWeqmAWUTjvobYjn4jDd1lNjywqmYam4cPDvvEE4QU0RY/1rJ23mKoJ+DxbSjS7o131u6rRzDn8YPMii49qz1yXKzNhmwTg8eu2eESBzLvL+/uzT/rP+/++d+VbMFXX71L00EMTBK1fCCVIEJN99MRGK4qTA3Si8PebIq20soHvvIRFLHWgywnaRHU+rOPEbFA/XLKPFDUfoIach6fbZovxQx8ZSQowr5jJauuM+kg2Tnx2m4uE5d3vw76jSao1nev4Evm00ExoxqWlv4lHTEiNsgXbd0SZxv7kQZerDIi1jHzIqDO5mqsWsu5v5+DIK8KocKxbpPkPGn8s83kB2XBCBFraWmoPcTMYb1xn7kLmjPhmOzGK2m/3pBfbYM/RBBhMbGgOROmZRdLUJA0if38cN59luvjnljQ6QnTsptAj6B1SbieI+9Ryb1tpyZiQVqkoHbNsuE96lAEZZ4GnE5Qly7hJIxWIzg4ZA2aZRrwVHawfQE/SVvF5MF1UM5pwOQ8sdKQ9kabMIk+pDioFRsxDZjNLpOIde92XpO0IjepoGMSRkwDjs5uOkGdG1s/EO96SkFHJYyYBjz+uakE9VLmOUfjXnWwoDEJI6YBj37uZEJEuxfEtdh6mvciSuxO1Q8KMYS+EXWSpOypQZFid+oEhW6kdg3y7r5ArNglilj2oedUglgCpW36BwswC0EZh57J+TzkQAdIqGNfgIkbWVA+4dxDz3m4QYZcb5r09HK3zca8d3TCqKFnu3tbb5rZCLKc4CdR0UQVockjBIgQYek1aMhRrO0+jdu+DRtn94MENPKJDevafI+hsFlL1kFDQ89k6KyvxRYg6GXwfV9mRNvme3WoR2snO4pDjjQZOtv2jIu9aKTrRfNhvtV/8fLFi5eB/ypt73/Zf03nCdclnIfyH/rf3DOLHxRdg3LrIOwQanUNCSdsKFJYd/LXIB4of0fQQbTnw1KkPz0dBA+VlLHgW6ZYMdMfNGjF2A0+8hAUvE0K6xpiIkNQhwIkEU/9i6GC9oIQBFvuLd8PMm9vq1SHgpYV6xZwVC8JIejuVu/nuGSCCE3SqSP3rMBhqHxRvrZ3h9QmqnEDV/PPUZxCDPYoUm6INmZfexpBSgtffboMgmTgTPoy5hMU10qdSpDaLn0xIkaNVnfAzHvdeN07RQetzddiCOqSRSy9/7oSBzr4EqZasTzIr4OkJ1XIl8vdPtZNKLLXxhR0esK07NJ56bBC/BshCS34WI8SrjqNJGjUunk+uxwiJr1jm7dlyj2ro61l8IdwQaPfKBtyEeS3Kig/7caW+xSdciyWIHI+iR/pNS6seQ52ZAhf5eQmaLZN3pKqTes2bFVIIV39kcN6JrMOUsg4u2OiiHnqx1onuOIVWQxYqqFrMoWgeTZ5S6fH6WNghs56mY5kR/FIbTHa/rTTylCusGdjynQOpqB8wpyzO8j5uMqDDAFBIClYgfKZlCQdlG12xxQRI95ySwG1XOVpSDHz+WZ3pC5m8STJ0iWxPuXTQKfkB0lq1pEOd4lUohHlFZw0puugaYgmyLuCqsb/Zznpdv7EFGM4ZboVSwJ9VxkvYpLIkv1ocUSKGC9hEVymKOkcu/3HE+Q6CZ0P6MYp0CekssLKjV+KzATlbM2T8+HKI4XTycRUYZKBF9makqrwkGvsCYXwRvPUoCwYoaSpx2wNGM1CDPrNKspXfW0Cfr2+sVNTqrUrRm4dlAdxIibRkFstFCCIf8uGpK2OkLmG9ar759aJY6UxgaAsQSAHCKLdpbYLjDa5GkOqrz/Qm13hjI312tK1aT0+/urib2/8XEXa1K+wltsIc5NAUJYgkDEihrrFjiYDE1uxag7CIeQCBO1u7EYUP754X4nYxaYRNrl//n6MPU5R0jmCQMbpIJMSXWPzI/xp9LL8DlTp1I1egEEdS1WFYdWhfH8C8lXdzUVQjiCQbREjTrETMLxivuA228r5jwnKB1GH4aChQSgbpdZ+u7jGjU7+J8ZEfnz7I33hg1d1gwljI9/dmtTKwl1LG9A4zZOeHgSyRZCZAAbzyRoq9Df+DncYpvb3pMwmYOa1O2i0i558I6SNifw1rZY/EG+pCI/v//pmXX/j5rcq2uoPdOBRFxsZwj+ak5UNaJygg7IEgRwSMaJ1rQaCG9SHosDCNHu2alM+OGiu6t4GgQ6tDvK4+47O+WLzudCD5vpHJQskNvIKwvcaJWYDGqeY+RxBILsEyY5sOXtuCWsTZNRR84kHyj6ZbRSUgL0Fs97l9qvvCBWh9G/KT6TBkhW2GJzchrqVLgDycvwg0pJopfIZ2wu3g6N5G3wtHb72QjQmSmhv509Nft9bKytfKwm7+vTLN3e3v9ARW5ETGhtZ5/Q6hP6lhiL+jbKhT0n7Jeo2BZrrVra3Yh2qQcaKSfAMqy/+XmnLz7/0R3XHK699dnv3TDMAsVr92MidGjTais0Y24f4PvhD0EkmZj6kg1bORWtq0f9e/aX6+u83f9SIWE0IgmDJfmxk/aPVQeuegrJvNFNsH9uqoCnCne+6APt7Pc2ta8UgKHHz01d+upL/fuUPei+cbzeK+vtCi9jFXzBY8krS2MiwiqC5qkZuIKBxipmfJbZPe7RvqKFN+nwDfpCdZ6pTvfIabBb0DyG+8DOlpL/1fGMDHldCTYh3sZFRK6EfdPlJmqOoS5R/P2lse8lhgqIAevtt7dLCnkFSki3MxhR0TMIRwz5j4mrkJgg11Uq3Vc2eQYqjetw2xkk6iBv2SQp+JLDV5VJMqEBmZ6k1+EHWcduOHo5JMfP8sE9s8KN22Ajfxmcc/kvHTH5QX/CjVnZnGYAtElHBj04ACQSxqwkNMgU/OjZSehQj7Xso+FGrQXGWIha/3HlC8KPlIN1R5DE0SH3GIhYfMOKJEgSOYgR4gs5UxGK7OwYJ0nghlo/RBMWDnyjTn2nvlZy3JOTVj1mUxnkSlGXomSvHKROUZeiZK8cJE5Rn6Jkrx0kTlGPomSvHCROUZ+iZK8cJE5Rn6JkrxykTlGXomSvHSRNUEIJT0s9g8DpHFTojdAiatsnb+QEIqlwrLseKhDNCpwYV+ChKmoElaHez0gOU0yZ3nCGAIJgZuc7TWD0nWCWtJ24pAzYtnPr5wRCkx3xMt33xg3xYgtZuhmwhiIIQZNRPjsbqOYHoID01aGo89bMDEKTnPqq6EztCD7dRvwBPBg4mZCahq8r0nTN/RiavOr5g1g8yc7R2N6METE2JxWmxeDJwMCEz3F7NTgmfkJdqb8YWbIonbQbIwC/Ak4GDCZnhItUYK8LkhTY7pmBTCAKtbgqMJwMHEzJT0/8MNRGzNbm8FBRBMQWbRJCu7PAXxZOBgwmZSfyqfsh2OUTkZZZFRRRsCkFGekGG8WTgYEJm0r4J2JJBhvi8tprjmIKdHEGQevCvHpGXXhMyN0HHETGTerBNHSNiipe5ReygStp/k2FbH6Ok3Wqr+ZT0Yc08EGReavivzuSFWcxt5g/sKForpntmhs0Yk5daj6LJmdlRRJfdNODqjiPfPZiQGVYbWPA9JS/Mgi9Y6ZNmUAhiUAhiUAhiUAhiUAhiUAhiUAhiUAhiUAhiUAhiUAhiUAhiUAhiUAhiUAhiUAhiUAhiUAhiUAhiUAhiUAhiUAhiUAhiUAhiUAhiUAhisASCpoU0mxmFIAaFIAbLIshELIAJTmqnfjOh9fHZe2qONE5aqUwoBJt+ViyKIIhYYGb1qN1ozLmd2WrXk1R62vTFxqaftXBLIgjXY6lZgzr8NJyb3aRtoANTwSqzs/bs67eWRJCNWGA2XbfzduHcpNChe8yKBHJ9zsItiiBYub9W0lSpICJwbgiygQ5qJAjTz4hFEYTTBbeXH5tKZE7dej/10apBM2NJBLnNQB9v39VqyIZBUAcY6ABmN8N+9XNjSQTZiAXqw+zPD+dYg3SgA9+KyXC8rWxYBEG4aUhtd+Hb4ixdgVXJBjrQN1x+SGIazoklEJSEQ63OPkGCtA6K3915Ik6QIOMOHGoHjVMk6KAoBDEoBDEoBDFYAkFdj3h/fwe7CNx0V7vZ3Q9qsT7AvmLLJKi+hjA5weWS5pLZM2v2zshFEqR/qEynUOgGdcn0qu3v5zb3CyFod6Pixa4gODosTl31rbdVkdjg0uy7+SyGIN0D3by03nNXK57q8uM+d3l387tWUMfZsBiCVqBVXNDYpjrZ6qHiDqnNaf5qb6ltX/3sm9IthiDSJWZ1Uo3tCRUgvSLBzxrCQPhmb5MtkaB2TNQuqqvPbiHY/FMkCONR9hGkeosgWt4TJci8dB9BxnusDjGmsUyCcCuKMEH7+0uzl5lSSU/HinXHLXpeHsObbVW/9ZPwgzqIH66Yf2BjkQTFR5V9Gm2xLmKbWE+kNb9oFIIY/B8tRua92Qm5XQAAAABJRU5ErkJggg==" /><!-- --></p>
<p>By checking Normal Q-Q and scale-location of residuals plot, we could
see that the residuals follow normality and constant variance.</p>
<p><strong><em>step3</em></strong>.Use the Gelman-Rubin method to
monitor convergence of the chain, and run the chain until it converges
approximately to the target distribution according to <span class="math inline">\(\small \hat R &lt; 1.2\)</span>.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">4</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">2</span><span class="sc">*</span>k, <span class="at">ncol=</span>N)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co">#initial setting</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>X[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span><span class="sc">+</span>k),<span class="dv">1</span>]<span class="ot">=</span><span class="fu">c</span>(mu1<span class="sc">+</span><span class="dv">1</span>, mu2<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>X[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span><span class="sc">+</span>k),<span class="dv">1</span>]<span class="ot">=</span><span class="fu">c</span>(mu1<span class="dv">-1</span>, mu2<span class="dv">-1</span>)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>X[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span><span class="sc">+</span>k),<span class="dv">1</span>]<span class="ot">=</span><span class="fu">c</span>(mu1<span class="dv">-5</span>, mu2<span class="dv">-5</span>)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>X[<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span><span class="sc">+</span>k),<span class="dv">1</span>]<span class="ot">=</span><span class="fu">c</span>(mu1<span class="sc">+</span><span class="dv">5</span>, mu2<span class="sc">+</span><span class="dv">5</span>)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  X[<span class="fu">c</span>(i,i<span class="sc">+</span>k), ] <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">Gibbs.ch</span>(N,sigma1,sigma2,mu1,mu2,s1,s2,<span class="fu">t</span>(X[<span class="fu">c</span>(i,i<span class="sc">+</span>k),])))</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">=</span> X[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,]</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">=</span> X[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>,]</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>psi<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(X1, <span class="dv">1</span>, cumsum))</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>psi<span class="fl">.2</span> <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(X2, <span class="dv">1</span>, cumsum))</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi<span class="fl">.1</span>)){</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  psi<span class="fl">.1</span>[i,] <span class="ot">=</span> psi<span class="fl">.1</span>[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi<span class="fl">.1</span>))</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  psi<span class="fl">.2</span>[i,] <span class="ot">=</span> psi<span class="fl">.2</span>[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi<span class="fl">.2</span>))</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>result_Q2 <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="fu">Gelman.Rubin</span>(psi<span class="fl">.1</span>),<span class="fu">Gelman.Rubin</span>(psi<span class="fl">.2</span>))),<span class="dv">3</span>)</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(result_Q2) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;X_t&quot;</span>,<span class="st">&quot;Y_t&quot;</span>)</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result_Q2) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Gelman.Rubin R_hat&quot;</span>)</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(result_Q2,<span class="at">caption =</span> <span class="st">&quot;Gelman-Rubin R_hat for X_t and Y_t&quot;</span>)</span></code></pre></div>
<table>
<caption>Gelman-Rubin R_hat for X_t and Y_t</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Gelman.Rubin R_hat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">X_t</td>
<td align="right">1.166</td>
</tr>
<tr class="even">
<td align="left">Y_t</td>
<td align="right">1.168</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>rhat<span class="fl">.1</span> <span class="ot">=</span> rhat<span class="fl">.2</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> b<span class="sc">:</span>N){</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  rhat<span class="fl">.1</span>[j] <span class="ot">=</span> <span class="fu">Gelman.Rubin</span>(psi<span class="fl">.1</span>[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  rhat<span class="fl">.2</span>[j] <span class="ot">=</span> <span class="fu">Gelman.Rubin</span>(psi<span class="fl">.2</span>[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat<span class="fl">.1</span>[b<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="at">main=</span><span class="fu">quote</span>(X[t]))</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat<span class="fl">.2</span>[b<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="at">main=</span><span class="fu">quote</span>(Y[t]))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAVFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6kNtmAABmtttmtv+QOgCQ2/+2ZgC2///bkDrbkJDb2//b////tmb/25D//7b//9v///9i9o7EAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGlklEQVR4nO3da3ebOBSFYdImmU7jxnHpBAP//3+Wi2HigNgS6HCOwn6/1GlZwn2WuMU2zmq2WKb9BKxHIBCBQAQCEQhEIBCBQAQCEQhEIBCBQAQCEQhEIBCBQAQCEQhEIBCBQAQCEQhEIBCBQAQCEQhEIBCBQAQCEQhEIJBloEv2Mjx4VXsSloHK07ff7Z9F9qT3JCwD1XknU50f3vSeg2mg6txuW/mwpalkGqi+Pj++l6fHd8WnYBuo2T3/yhX30LV5oPL0/VlxD12bB2qOYP2RTC3rQOVJdwIlA3T9oTSRCARKBKg8ZUpni4kAcQa5IpBnBAIRCHT9R+mKPhWg/sJeoVSA1CIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBIoMlCWTFlDc4eQiEIhAIF0g/y1cLeUZRCAwHIHAcPa3Me2dNIHAcOankDaQ+Sm0M9D0DJ5AYDjr25g6kPUpZADItpA+kPEpRCCQBSDTQiJA5am9DUvRHMydd0P4OJxpITmgvL0XS3lyfLotc/5gLDGgG03uuGXNPZBhITGg63MHVDg2smzhJ1OZmEGWp5AQUHu19VQPu2s83MGA6uEeGoXzrmKfgcwKGTgPkhg+XmaArApJAjVnis5b1UyGOxjQJcterj/fPU8Uu78wKiQDdGkO7pdu9vgd5oNXsF9Ch/nX4S4jfieK3d/YFBK8WK3+q0NmkNEpJLOJ5cO8+XyiuPS2G5tTSGgnnfeHr8J5q5q54Y4EtGo4k1PIEpDJKSQNlHsfxWqbU8jUDLI4hWwBGRSyBmROyBiQPSFrQOY2MsFfufaFHMW6fzAmJDODqjO6f7p7OGNCQptYdQY3UF8Y7hBAC1dheDhTQuZ20rWxjcwikCkhk0B1wMe0pLMJZGgSbQD6s+XW33C9VoSCgfLbuR8+1dm4XiNCoUDFw1v3ok6RbfsyL4/1JgnUnQCWp9d85dd7BH1W1sQcCgTqXqWozv9u/jJBr/VaEAoGak+QL9u/K89vvQaE1gFt/648z/XqC60D2v5VXr7rVReyDqQuZB5IWygYCP6uMPJ6tYWsXovdLasplAKQqlASQJpCaQApCiUCpHflmgyQllAqQGpCyQBpCaUDpCSUEJDOax0pAalMorSAFCbRzkDh92+cGSHKM/FeX/QFxYfblyhBoH13RUkC7TmJ0gTakShVoN2I0gXaiUgIqDqD31tHO2uIMs7SKqIv2JYPL7067ywQ6z8mLiQCVJ1HloCPZK5LehKJAH34MLj/h3pXJ0uU/AzqR5MzktoH3aaQ+D5oHE+KSOgoNrwC63wbSPz/jhBRyudB00EFjL4UkASREFDePNP+Fl3yR7FPA0c2EtpJP7w1u6H2TTK7A9W338pFGyz6gvVwmK/OzS5aA6gbP5aS6Ini5fFdC6hfSQQk2RPFy5MqULeijUhC+6AbS3M6dA80+eKlXf7ctD4RoPFU2vmJjt1f4Fo7k77YeRBaa7jSsYC6NYchSQOp76Tn1+5vdLwZNDwBT6PDAtWeRkcGqn12SAcHaltGIlCXG0noWuz/s1eTR7HZ5q9vZWbQlru/6DZBEntldf3dX9S7Q5LaB225+4uFRiPupEEEAhEIRCCQGlAyKQGFDeq5nMpiKxePOyiB4ixHIIuLrVw87qAEirMcgSwutnLxuIMSKM5yXw/oK0UgEIFABAIRCEQgEIFABAIRCEQgEIFABAIRCBQfaOmroOvrj993y0wf+Je7B1kxmqvoQO3d8QvXsytP3ftnxmWmD/xr32jrGGTFaM5iA/Wf53DcV7jo33g1LjN94N/tLvNzg6wYzV1soOtz+/6Y+bdRF9lL93HycZnpg8C1tUDxRpstOtDid2X3/zAuM30QuLb2E37xRpstNlC/6Tt3AN2zHpeZPghbV/clILFGc5QyUP/px8SA9t3EWoXENjGwg4y8k26HSmwnDQ6xRbTDfK/QjJfYYR6cpBXxThTbr0npKNI6UfxwBTDXbccwLjN94N8lG+5yEGM0V7xYBREIRCAQgUAEAhEIRCAQgUAEAhEIRCAQgUAEAhEIRCAQgUAEAhEIRCAQgUAEAhEIRCAQgUAEAhEIRCAQgUAEAhEIRCAQgUAEAhEIRCAQgUAEAhEIRCAQgUAEAhEIRCAQgUAEAhEIRCAQgUAEAhEIRCAQgUAEAhEIRCAQgUAEAhEIRCAQgUAEAhEIRCDQXw/uihSz2BqJAAAAAElFTkSuQmCC" /><!-- --></p>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
</div>
<div id="HW8" class="section level2">
<h2>HW8</h2>
<hr />
<div id="question81ans" class="section level3">
<h3>Question 1</h3>
<p><strong><em>step0</em></strong>. library packages.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span></code></pre></div>
<p><strong><em>step1</em></strong>. Computation of <span class="math inline">\(\small SE(\hat \alpha \hat \beta)\)</span></p>
<p><span class="math display">\[SE(\hat \alpha \hat \beta) = \sqrt{\hat
\alpha S_\beta^2+\hat \beta S_\alpha^2}\]</span></p>
<p><strong><em>step2</em></strong>. <span class="math inline">\(\small
\alpha = 0,\beta = 1,\gamma = 1\)</span></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b,sa,sb){</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>sb<span class="sc">+</span>b<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>sa)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>statis <span class="ot">&lt;-</span> <span class="cf">function</span>(x,m,y){</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  model1 <span class="ot">=</span> <span class="fu">summary</span>(<span class="fu">lm</span>(y<span class="sc">~</span>m<span class="sc">+</span>x))<span class="sc">$</span>coefficients</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  model2 <span class="ot">=</span> <span class="fu">summary</span>(<span class="fu">lm</span>(m<span class="sc">~</span>x))<span class="sc">$</span>coefficients</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">=</span> model2[<span class="dv">2</span>]</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  se_alpha <span class="ot">=</span> model2[<span class="dv">4</span>]</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">=</span> model1[<span class="dv">2</span>]</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  se_beta <span class="ot">=</span> model1[<span class="dv">5</span>]</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  T <span class="ot">=</span> alpha<span class="sc">*</span>beta<span class="sc">/</span><span class="fu">SE</span>(alpha,beta,se_alpha<span class="sc">^</span><span class="dv">2</span>,se_beta<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(T)</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="co">#initial</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>p_per1 <span class="ot">=</span> p_per2 <span class="ot">=</span> p_per3 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a><span class="co">#testing</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>){</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">=</span> <span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">10</span>)</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#a_M = 0, a_Y = 0, alpha = 0,beta=1,gamma = 1</span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>  e_M <span class="ot">=</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>  e_Y <span class="ot">=</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">=</span> e_M</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">=</span> X<span class="sc">+</span>M<span class="sc">+</span>e_Y</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#permutation of X and M</span></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>  R <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>  reps <span class="ot">=</span> <span class="fu">numeric</span>(R)</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>  to <span class="ot">=</span> <span class="fu">statis</span>(X,M,Y)</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">#generate indices k.</span></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">=</span> X[k]</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">=</span> M</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>    y1 <span class="ot">=</span> Y</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>    model1 <span class="ot">=</span> <span class="fu">summary</span>(<span class="fu">lm</span>(Y<span class="sc">~</span>M<span class="sc">+</span>X))<span class="sc">$</span>coefficients</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>    model2 <span class="ot">=</span> <span class="fu">summary</span>(<span class="fu">lm</span>(m1<span class="sc">~</span>x1))<span class="sc">$</span>coefficients</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>    alpha <span class="ot">=</span> model2[<span class="dv">2</span>]</span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>    se_alpha <span class="ot">=</span> model2[<span class="dv">4</span>]</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">=</span> model1[<span class="dv">2</span>]</span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>    se_beta <span class="ot">=</span> model1[<span class="dv">5</span>]</span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>    reps[i] <span class="ot">=</span> alpha<span class="sc">*</span>beta<span class="sc">/</span><span class="fu">SE</span>(alpha,beta,se_alpha<span class="sc">^</span><span class="dv">2</span>,se_beta<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(reps) <span class="sc">&gt;=</span> <span class="fu">abs</span>(to))</span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p1<span class="sc">&lt;</span><span class="fl">0.05</span>) p_per1 <span class="ot">=</span> p_per1<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong><em>step3</em></strong>. <span class="math inline">\(\small
\alpha = 1,\beta = 0,\gamma = 1\)</span>.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>){</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#a_M = 0, a_Y = 0, alpha = 1, beta=0,gamma = 1</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">=</span> <span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">10</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#a_M = 0, a_Y = 0, alpha = 0,beta=1,gamma = 1</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  e_M <span class="ot">=</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  e_Y <span class="ot">=</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">=</span> X<span class="sc">+</span>e_M</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">=</span> X<span class="sc">+</span>e_Y</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#permutation of Y and M</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  reps <span class="ot">=</span> <span class="fu">numeric</span>(R)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  to <span class="ot">=</span> <span class="fu">statis</span>(X,M,Y)</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#generate indices k.</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">=</span> X</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    y1 <span class="ot">=</span> Y[k]</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">=</span> M</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>    model1 <span class="ot">=</span> <span class="fu">summary</span>(<span class="fu">lm</span>(y1<span class="sc">~</span>m1<span class="sc">+</span>x1))<span class="sc">$</span>coefficients</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>    model2 <span class="ot">=</span> <span class="fu">summary</span>(<span class="fu">lm</span>(M<span class="sc">~</span>X))<span class="sc">$</span>coefficients</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>    alpha <span class="ot">=</span> model2[<span class="dv">2</span>]</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>    se_alpha <span class="ot">=</span> model2[<span class="dv">4</span>]</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">=</span> model1[<span class="dv">2</span>]</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>    se_beta <span class="ot">=</span> model1[<span class="dv">5</span>]</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>    reps[i] <span class="ot">=</span> alpha<span class="sc">*</span>beta<span class="sc">/</span><span class="fu">SE</span>(alpha,beta,se_alpha<span class="sc">^</span><span class="dv">2</span>,se_beta<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(reps) <span class="sc">&gt;=</span> <span class="fu">abs</span>(to))</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p2<span class="sc">&lt;</span><span class="fl">0.05</span>) p_per2 <span class="ot">=</span> p_per2<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>} </span></code></pre></div>
<p><strong><em>step4</em></strong>.<span class="math inline">\(\small
\alpha = 0,\beta = 0,\gamma = 1\)</span>.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>){</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#a_M = 0, a_Y = 0, alpha = 0, beta=0,gamma = 1</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">=</span> <span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">10</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#a_M = 0, a_Y = 0, alpha = 0,beta=1,gamma = 1</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  e_M <span class="ot">=</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  e_Y <span class="ot">=</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">=</span> e_M</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">=</span> X<span class="sc">+</span>e_Y</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#permutation of X, M and Y.</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  reps <span class="ot">=</span> <span class="fu">numeric</span>(R)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  to <span class="ot">=</span> <span class="fu">statis</span>(X,M,Y)</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#generate indices k.</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">=</span> X</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">=</span> M[k]</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>    y1 <span class="ot">=</span> Y</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>    model1 <span class="ot">=</span> <span class="fu">summary</span>(<span class="fu">lm</span>(y1<span class="sc">~</span>m1<span class="sc">+</span>x1))<span class="sc">$</span>coefficients</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>    model2 <span class="ot">=</span> <span class="fu">summary</span>(<span class="fu">lm</span>(m1<span class="sc">~</span>x1))<span class="sc">$</span>coefficients</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>    alpha <span class="ot">=</span> model2[<span class="dv">2</span>]</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>    se_alpha <span class="ot">=</span> model2[<span class="dv">4</span>]</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">=</span> model1[<span class="dv">2</span>]</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>    se_beta <span class="ot">=</span> model1[<span class="dv">5</span>]</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>    reps[i] <span class="ot">=</span> alpha<span class="sc">*</span>beta<span class="sc">/</span><span class="fu">SE</span>(alpha,beta,se_alpha<span class="sc">^</span><span class="dv">2</span>,se_beta<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>  p3 <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(reps) <span class="sc">&gt;=</span> <span class="fu">abs</span>(to))</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p3<span class="sc">&lt;</span><span class="fl">0.05</span>) p_per3 <span class="ot">=</span> p_per3<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong><em>step5</em></strong>. Conclusion.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>result_Q1 <span class="ot">=</span> <span class="fu">c</span>(p_per1<span class="sc">/</span><span class="dv">500</span>, p_per2<span class="sc">/</span><span class="dv">500</span>, p_per3<span class="sc">/</span><span class="dv">500</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>table_Q1 <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">matrix</span>(result_Q1),<span class="dv">5</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table_Q1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;alpha=0&quot;</span>,<span class="st">&quot;beta=0&quot;</span>,<span class="st">&quot;alpha=beta=0&quot;</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table_Q1) <span class="ot">=</span> <span class="st">&quot;Type 1 error rate&quot;</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(table_Q1,<span class="at">caption =</span> <span class="st">&quot;Type 1 error rate for Different Occasions&quot;</span>)</span></code></pre></div>
<table>
<caption>Type 1 error rate for Different Occasions</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Type 1 error rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha=0</td>
<td align="right">0.052</td>
</tr>
<tr class="even">
<td align="left">beta=0</td>
<td align="right">0.052</td>
</tr>
<tr class="odd">
<td align="left">alpha=beta=0</td>
<td align="right">0.046</td>
</tr>
</tbody>
</table>
<p>At each occasion, type 1 error rate is about 0.05, which is exactly
equal to the rate we set. The result show that with <span class="math inline">\(\small H_0\)</span> is satisfied, type 1 error
rate could be controlled.</p>
</div>
<div id="question82ans" class="section level3">
<h3>Question 2</h3>
<p><strong><em>step1</em></strong>. Define an R-function to achieve the
functions, input: <span class="math inline">\(\small
N,b_1,b_2,b_3,f_0\)</span>, output: <span class="math inline">\(\small
\alpha\)</span></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define the function.</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>Q2func <span class="ot">&lt;-</span> <span class="cf">function</span>(N,b1,b2,b3,f0){</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">=</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>) </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">=</span> <span class="fu">rexp</span>(N,<span class="dv">1</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  x3 <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,N,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">=</span> <span class="cf">function</span>(alpha){</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">=</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(p) <span class="sc">-</span> f0</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  solution <span class="ot">=</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">0</span>))</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">=</span> solution<span class="sc">$</span>root</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(alpha)</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong><em>step2</em></strong>.Call this function with input <span class="math inline">\(\small
N=1e6,b_1=0,b_2=1,b_3=-1,f_0=0.1,0.01,0.001,0.0001.\)</span></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>f0 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>Q2func1 <span class="ot">&lt;-</span> <span class="cf">function</span>(f0){</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">=</span> <span class="fl">1e6</span>; b1 <span class="ot">=</span> <span class="dv">0</span>; b2 <span class="ot">=</span> <span class="dv">1</span>; b3 <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Q2func</span>(N,b1,b2,b3,f0)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>result_Q2 <span class="ot">=</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(f0, Q2func1))</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="co">#codes below are to show the result in the form of table.</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>table_Q2 <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(f0,result_Q2),<span class="at">nrow =</span> <span class="fu">length</span>(f0)),<span class="dv">3</span>)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table_Q2) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;f0&quot;</span>,<span class="st">&quot;alpha&quot;</span>)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table_Q2) <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(table_Q2,<span class="at">caption =</span> <span class="st">&quot;Table of Alpha vs F0&quot;</span>)</span></code></pre></div>
<table>
<caption>Table of Alpha vs F0</caption>
<thead>
<tr class="header">
<th align="right">f0</th>
<th align="right">alpha</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.100</td>
<td align="right">-3.165</td>
</tr>
<tr class="even">
<td align="right">0.010</td>
<td align="right">-6.067</td>
</tr>
<tr class="odd">
<td align="right">0.001</td>
<td align="right">-8.713</td>
</tr>
<tr class="even">
<td align="right">0.000</td>
<td align="right">-11.227</td>
</tr>
</tbody>
</table>
<p><strong><em>step3</em></strong>. Take out the figure of <span class="math inline">\(\small \ f_0 \  vs. \ \alpha\)</span>.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result_Q2, f0, <span class="at">pch =</span> <span class="dv">16</span>,<span class="at">xlab =</span> <span class="st">&quot;alpha&quot;</span>,<span class="at">main =</span> <span class="st">&quot;f0 vs alpha&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
</div>
<div id="HW9" class="section level2">
<h2>HW9</h2>
<hr />
<div id="question91ans" class="section level3">
<h3>Question 1</h3>
<p><strong><em>step0</em></strong>. library packages.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span></code></pre></div>
<p><strong><em>step1</em></strong>.</p>
<p><strong>2.1.3.4</strong> Why do you need to use unlist() to convert a
list to an atomic vector? Why doesn’t as.vector() work?</p>
<p><strong>Solution:</strong> Given a list structure x, unlist()
simplifies it to produce a vector which contains all the atomic
components which occur in x. as.vector() is to convert an array to a
vector, if it is used to a list, the list will be taken an element of
the vector, which is not an atomic vector.</p>
<p><strong><em>step2</em></strong>.</p>
<p><strong>2.1.3.5</strong> Why is 1 == “1” true? Why is -1 &lt; FALSE
true? Why is “one” &lt; 2 false?</p>
<p><strong>Solution:</strong></p>
<ul>
<li>1 == “1” is true because when we use “==”, R will automatically
identifies whether the data types are the same, if not, there’s the list
of orders of different data types(decreasing): character, complex,
numeric, integer, logical and raw, the one in the lower order will be
automatically converted to the same to the higher one.<br />
</li>
<li>Logical “FALSE” has the value 0, that’s why -1&lt;FALSE is
true.</li>
<li>When compare to things in R with “&lt;”,“&gt;”,“==”, or somehing
like that, the real things that are compared is the ASCII code of each
other, the ASCII code of “one” is (111,110,101), which is larger than
50–the ASCII code of 2.</li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">utf8ToInt</span>(<span class="st">&quot;one&quot;</span>);<span class="fu">utf8ToInt</span>(<span class="st">&quot;2&quot;</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 111 110 101</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 50</span></span></code></pre></div>
</div>
<div id="question92ans" class="section level3">
<h3>Question 2</h3>
<p><strong><em>step1</em></strong>.</p>
<p><strong>2.3.1.1</strong> What does dim() return when applied to a
vector?</p>
<p><strong>Solution:</strong> It will return NULL, because for an array
(and hence in particular, for a matrix) dim() retrieves the dim
attribute of the object, vectors are dimensionless in R.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; NULL</span></span></code></pre></div>
<p><strong><em>step2</em></strong>.</p>
<p><strong>2.3.1.2</strong> If is.matrix(x) is TRUE, what will
is.array(x) return?</p>
<p><strong>Solution:</strong> TRUE, matrix is a special form of array in
R.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>mat1 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.matrix</span>(mat1);<span class="fu">is.array</span>(mat1)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div id="question93ans" class="section level3">
<h3>Question 3</h3>
<p><strong><em>step1</em></strong>.</p>
<p><strong>2.4.5.1</strong> What attributes does a data frame
possess?</p>
<p><strong>solution:</strong> names,class,row.names.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(data1)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $names</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;c.1..2.&quot;</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $class</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;data.frame&quot;</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $row.names</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1 2</span></span></code></pre></div>
<p><strong><em>step2</em></strong>.</p>
<p><strong>2.4.5.2</strong> What does as.matrix() do when applied to a
data frame with columns of different types?</p>
<p><strong>solution:</strong> As.matrix() will automatically convert the
one with lower order of data type to the same to the higher one(order
list showed before), thus whole data possess the same data type.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">num =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">char =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>))</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>data2;<span class="fu">as.matrix</span>(data2)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   num char</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   1    a</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   2    b</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      num char</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] &quot;1&quot; &quot;a&quot; </span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] &quot;2&quot; &quot;b&quot;</span></span></code></pre></div>
<p><strong><em>step3</em></strong>.</p>
<p><strong>2.4.5.3</strong> Can you have a data frame with 0 rows? What
about 0 columns?</p>
<p><strong>solution:</strong> We could have them all as showed
below.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#data frame with 0 rows</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>data3 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">num=</span><span class="fu">integer</span>())</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>data3;<span class="fu">class</span>(data3)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] num</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;0 行&gt; (或0-长度的row.names)</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;data.frame&quot;</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="co">#data frame with 0 columns</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>data4 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="dv">1</span>)[,<span class="dv">0</span>,drop<span class="ot">=</span><span class="cn">FALSE</span>]</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data4);<span class="fu">class</span>(data4)</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1 0</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;data.frame&quot;</span></span></code></pre></div>
<p><a href="#question">Back to the Question</a></p>
</div>
<div id="question94ans" class="section level3">
<h3>Question 4</h3>
<p>Parameter estimate of Exp(<span class="math inline">\(\small
\lambda\)</span>) with MLE and EM algorithm for interval data.</p>
<p><strong><em>step1</em></strong>. Verify the result of MLE and EM by
derivation.</p>
<ul>
<li><strong>direct MLE with observed data:</strong></li>
</ul>
<p>Likelihood function: <span class="math display">\[\begin{align*}
  L(\lambda) &amp;= \Pi_{i=1}^{n}P_\lambda(u_i\le X_i\le v_i) \\
    &amp;= \Pi_{i=1}^{n}(e^{-\lambda u_i}-e^{-\lambda v_i}), \\
\end{align*}\]</span> log-likelihood function: <span class="math display">\[\begin{align*}
  l(\lambda) &amp;= \sum_{i=1}^{n}log(e^{-\lambda u_i}-e^{-\lambda v_i})
\\
    &amp;= \sum_{i=1}^{n}log(1-e^{-\lambda D_i})-C\lambda, \\
\end{align*}\]</span> where <span class="math display">\[\begin{align*}
  D_i &amp;= v_i-u_i \\
    C &amp;= \sum_{i=1}^{n}u_i \\
\end{align*}\]</span> <span class="math display">\[\frac{\partial l
}{\partial \lambda} = \sum_{i=1}^{n}\frac{D_ie^{-D_i \lambda}}{1-e^{-D_i
\lambda}}-C,\]</span> and <span class="math display">\[\frac{\partial^2
l }{\partial \lambda^2} = -\sum_{i=1}^{n}\frac{D_i^2e^{-D_i
\lambda}}{(1-e^{-D_i \lambda})^2}&lt;0,\]</span> which verify the
existence of MLE <span class="math inline">\(\small \hat
\lambda\)</span> and it is unique, which is the one that makes <span class="math inline">\(\small \frac{\partial l }{\partial
\lambda}=0\)</span>.</p>
<ul>
<li><strong>MLE with EM algorithm:</strong></li>
</ul>
<p><strong>E-step:</strong> <span class="math display">\[\begin{align*}
  E_\lambda(X|u_i&lt;X&lt;v_i) &amp;=
\frac{\int_{u_i}^{v_i}xf(x)dx}{\int_{u_i}^{v_i}f(x)dx} \\
    &amp;=
\frac{(-xe^{-x\lambda}-\frac{1}{\lambda}e^{-x\lambda})|_{u_i}^{v_i}}{(1-e^{-x\lambda})|_{u_i}^{v_i}}
\\
    &amp;=\frac{u_ie^{-u_i\lambda}-v_ie^{-v_i\lambda}+\frac{1}{\lambda}e^{-u_i\lambda}-\frac{1}{\lambda}e^{-v_i\lambda}}{e^{-u_i\lambda}-e^{-v_i\lambda}}
\end{align*}\]</span></p>
<p>update <span class="math inline">\(\lambda\)</span>:</p>
<p><span class="math display">\[\lambda_{k+1} =
\frac{n}{\sum_{i=1}^{n}\frac{u_ie^{-u_i\lambda_k}-v_ie^{-v_i\lambda_k}+\frac{1}{\lambda_k}e^{-u_i\lambda_k}-\frac{1}{\lambda_k}e^{-v_i\lambda_k}}{e^{-u_i\lambda_k}-e^{-v_i\lambda_k}}}\]</span></p>
<ul>
<li><strong>Proof of the consistency of the results of the two
algorithms:</strong></li>
</ul>
<p>suppose <span class="math inline">\(\hat \lambda\)</span> is the MLE
of observed data, then: <span class="math display">\[\sum_{i=1}^{n}\frac{u_ie^{-u_i\hat
\lambda}-v_ie^{-v_i\hat \lambda}}{e^{-u_i\hat \lambda}-e^{-v_i\hat
\lambda}}=0,\]</span> with which we got: <span class="math display">\[\begin{align*}
  \lambda_{k+1} &amp;=
\frac{n}{\sum_{i=1}^{n}\frac{u_ie^{-u_i\lambda_k}-v_ie^{-v_i\lambda_k}+\frac{1}{\lambda_k}e^{-u_i\lambda_k}-\frac{1}{\lambda_k}e^{-v_i\lambda_k}}{e^{-u_i\lambda_k}-e^{-v_i\lambda_k}}}
\\
    &amp;=\frac{n}{\sum_{i=1}^{n}\frac{\frac{1}{\lambda_k}e^{-u_i\lambda_k}-\frac{1}{\lambda_k}e^{-v_i\lambda_k}}{e^{-u_i\lambda_k}-e^{-v_i\lambda_k}}}
\\
    &amp;=\lambda_k,
\end{align*}\]</span> which means that the results of the two algorithms
are consistent.</p>
<p><strong><em>step2</em></strong>. Numeric example.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># direct MLE</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>mle_Q4 <span class="ot">&lt;-</span> <span class="cf">function</span>(U,V,lam){</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  D <span class="ot">=</span> V<span class="sc">-</span>U</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  C <span class="ot">=</span> <span class="fu">sum</span>(U)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  L <span class="ot">=</span> <span class="fu">sum</span>(D<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>D<span class="sc">*</span>lam)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>D<span class="sc">*</span>lam)))<span class="sc">-</span>C</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(L)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>E_step <span class="ot">&lt;-</span> <span class="cf">function</span>(U,V,lam){</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  s1 <span class="ot">=</span> <span class="sc">-</span>V<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lam<span class="sc">*</span>V)<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>lam<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lam<span class="sc">*</span>V)<span class="sc">+</span>U<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lam<span class="sc">*</span>U)<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>lam<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lam<span class="sc">*</span>U)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  s2 <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lam<span class="sc">*</span>V)<span class="sc">-</span><span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>lam<span class="sc">*</span>U)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  s1<span class="sc">/</span>s2</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>M_step <span class="ot">&lt;-</span> <span class="cf">function</span>(U,V,lam){</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">E_step</span>(U,V,lam)</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  lam_new <span class="ot">=</span> <span class="fu">length</span>(U)<span class="sc">/</span><span class="fu">sum</span>(x)</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(lam_new<span class="sc">-</span>lam)<span class="sc">&gt;</span><span class="fl">0.0001</span>) <span class="fu">M_step</span>(U,V,lam_new)</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">return</span>(lam_new)</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>U <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>V <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>lam0 <span class="ot">=</span> <span class="dv">1</span> <span class="co">#initial value of EM.</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>mlE <span class="ot">&lt;-</span> <span class="cf">function</span>(lam){</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mle_Q4</span>(U,V,lam)</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>result_mle <span class="ot">=</span> <span class="fu">uniroot</span>(mlE,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">$</span>root</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>result_EM <span class="ot">=</span> <span class="fu">M_step</span>(U,V,lam0)</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(result_mle,result_EM)),<span class="dv">5</span>)</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(result) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;direct MLE&quot;</span>,<span class="st">&quot;EM&quot;</span>)</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result)  <span class="ot">=</span> <span class="st">&quot;lambda estimate&quot;</span></span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(result,<span class="at">caption =</span> <span class="st">&quot;MLE of lambda using different algorithms&quot;</span>)</span></code></pre></div>
<table>
<caption>MLE of lambda using different algorithms</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">lambda estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">direct MLE</td>
<td align="right">0.07196</td>
</tr>
<tr class="even">
<td align="left">EM</td>
<td align="right">0.07197</td>
</tr>
</tbody>
</table>
<p><a href="#question">Back to the Question</a></p>
<hr />
</div>
</div>
<div id="HW10" class="section level2">
<h2>HW10</h2>
<hr />
<div id="question101ans" class="section level3">
<h3>Question 1</h3>
<p><strong><em>step0</em></strong>. library packages.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<p><strong><em>step1</em></strong>. Apply it to every column of a data
frame.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#function definition.</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">num1=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>),<span class="at">num2=</span><span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">9</span>))</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(data1, <span class="dv">2</span>, scale01)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           num1      num2</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.0000000 0.0000000</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.4444444 0.6666667</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,] 1.0000000 1.0000000</span></span></code></pre></div>
<p><strong><em>step2</em></strong>. Apply it to every numeric column of
a data frame.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#consider of the situation that there&#39;s any other type of data in some columns.</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">num1=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>),<span class="at">num2=</span><span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">9</span>),<span class="at">name=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>))</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co">#select columns that only contain numeric data.</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>num_cols <span class="ot">=</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(data2, is.numeric)) </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(data2[,num_cols], <span class="dv">2</span>, scale01)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           num1      num2</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.0000000 0.0000000</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.4444444 0.6666667</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,] 1.0000000 1.0000000</span></span></code></pre></div>
</div>
<div id="question102ans" class="section level3">
<h3>Question 2</h3>
<p><strong><em>step1</em></strong>. Compute the standard deviation of
every column in a numeric data frame.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(data1, sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     num1     num2 </span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4.509250 1.527525</span></span></code></pre></div>
<p><strong><em>step2</em></strong>. Compute the standard deviation of
every numeric column in a mixed data frame. (Hint: you’ll need to use
vapply() twice.)</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#select columns that only contain numeric data.</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>data2</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   num1 num2 name</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    1    6    A</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    5    8    B</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   10    9    C</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>num_cols <span class="ot">=</span> <span class="fu">vapply</span>(data2, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>)) </span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(data2[,num_cols], sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     num1     num2 </span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4.509250 1.527525</span></span></code></pre></div>
</div>
<div id="question103ans" class="section level3">
<h3>Question 3</h3>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\(\small (X_t, Y_t)\)</span> with zero means, unit
standard deviations, and correlation 0.9.</p>
<p><strong><em>step0</em></strong>. Library packages.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp) </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<p><strong><em>step1</em></strong>. Write an Rcpp function.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define function &quot;Gibbs_binorm&quot;</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Can create source file in Rstudio</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sourceCpp(&quot;Gibbsbinorm.cpp&quot;)</span></span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize constants and parameters</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">=</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">=</span> <span class="fl">0.9</span> <span class="co">#correlation</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the chain</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">=</span> <span class="fu">c</span>(mu1, mu2) <span class="co">#initialize</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">Gibbs_binorm</span>(N,sigma1,sigma2,mu1,mu2,rho,s1,s2,X)</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(X[t]),<span class="at">ylab=</span><span class="fu">bquote</span>(Y[t]), <span class="at">ylim=</span><span class="fu">range</span>(x[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong><em>step2</em></strong>. Compare the corresponding generated
random numbers with pure R language using the function “qqplot”.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>Gibbs.ch <span class="ot">&lt;-</span> <span class="cf">function</span>(N,sigma1,sigma2,mu1,mu2,rho,s1,s2,X){</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">=</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">=</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">=</span> X[i, <span class="dv">1</span>]</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">=</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">2</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>X1[<span class="dv">1</span>,] <span class="ot">=</span> <span class="fu">c</span>(mu1, mu2) <span class="co">#initialize</span></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">=</span> <span class="fu">Gibbs.ch</span>(N,sigma1,sigma2,mu1,mu2,rho,s1,s2,X1)</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">=</span> X1[b<span class="sc">:</span>N, ]</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(x1[,<span class="dv">1</span>],x[,<span class="dv">1</span>],<span class="at">xlab =</span> <span class="st">&quot;pure R language-X&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;Cpp-X&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(x1[,<span class="dv">2</span>],x[,<span class="dv">2</span>],<span class="at">xlab =</span> <span class="st">&quot;pure R language-Y&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;Cpp-Y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Result seems like the two are consistent.</p>
<p><strong><em>step3</em></strong>. Compare the computation time of the
two functions with the function “microbenchmark”.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">GibbsR=</span><span class="fu">Gibbs.ch</span>(N,sigma1,sigma2,mu1,mu2,rho,s1,s2,X),<span class="at">Gibbscpp=</span><span class="fu">Gibbs_binorm</span>(N,sigma1,sigma2,mu1,mu2,rho,s1,s2,X))</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       expr       lq   median      uq</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   GibbsR 34.41360 35.18260 39.9235</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Gibbscpp  1.85545  1.89375  1.9834</span></span></code></pre></div>
<p>We could see that computation time of Cpp is about 1/25 of the one
with pure R language, which means that Cpp significantly improved the
computational speed.</p>
<p><a href="#question">Back to the Question</a></p>
<hr />
<hr />
<center>
<font color="Red" size="4"><strong>Note:You may encounter problems with the
formula display in HTML, please knit the RMD to solve it
</strong></font>
</center>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
